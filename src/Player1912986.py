import numpy

from NeuralNetwork import NeuralNetwork


GRID_COUNT = 3
ROW_LENGTH = 3
COLUMN_LENGTH = 3

#INPUT_SIZE = GRID_COUNT * 2 + ROW_LENGTH * 2 + COLUMN_LENGTH * 2 + 1 + 1
INPUT_SIZE = GRID_COUNT * 2 + ROW_LENGTH * 2 + COLUMN_LENGTH * 2
OUTPUT_SIZE = GRID_COUNT * ROW_LENGTH * COLUMN_LENGTH


class NNPlayer:
    @staticmethod
    def getSpecs():
        return (INPUT_SIZE, OUTPUT_SIZE)

    def __init__(self, weights, biases, activiation_functions):
        weights = [
[[-1.85970606e-01,-2.34296237e-01, 2.24328943e-01, 2.51403856e-01,
  -2.15717167e-01,-2.35556221e-02, 1.38962857e-01,-1.79794174e-01,
   9.39496937e-02, 1.40496867e-01,-2.73674990e-01, 3.29065467e-02,
   5.88295277e-01,-5.02104185e-01,-3.92746346e-01,-1.19357763e-01,
  -7.42056327e-01, 1.75950967e-01],
 [ 5.98192560e-02, 1.86516850e-01,-7.94836174e-01,-3.02028969e-01,
   5.41720018e-02,-3.45671516e-01, 2.59962461e-01, 2.17344778e-01,
  -6.07860916e-01, 5.46930440e-02,-3.13337067e-01,-6.32033941e-01,
   2.22604247e-01, 5.92747214e-01, 1.39432283e-01, 3.06947269e-01,
   1.84627449e-01,-2.29917803e-01],
 [-4.27811082e-02, 4.10041435e-01,-3.95100115e-01, 1.11137489e-01,
  -4.18651398e-01, 1.61510187e-01, 5.01431253e-01, 6.91501491e-01,
   4.35962469e-01,-1.56078312e-01,-9.85263136e-02,-1.39425194e-01,
   1.02302191e+00,-5.55021006e-01, 6.82368795e-02,-3.75830436e-01,
   6.76843605e-02, 1.89814360e-01],
 [-1.55993934e-01, 5.16616867e-01,-2.19033923e-01,-4.38847363e-02,
   1.65778756e-01, 4.24181868e-02, 4.28471101e-01,-3.91749215e-01,
  -5.72092612e-02,-2.21792108e-01,-3.01296291e-01,-6.40635435e-01,
  -9.21139447e-02,-4.55634470e-02, 1.37790733e-01,-1.75910868e-01,
   5.97828682e-01, 1.21341553e-01],
 [ 4.17505704e-02, 1.08279882e-01, 4.04753477e-01,-1.74072033e-01,
   5.19091718e-01,-2.09282840e-01, 4.88310360e-02,-2.98697503e-01,
  -4.90544024e-01, 2.08896993e-01, 3.53709455e-02,-2.39655988e-01,
  -1.03296894e-01,-6.25759522e-02,-6.53921394e-02,-5.72678171e-01,
   4.71205908e-01, 2.20210436e-01],
 [-6.28753886e-01, 1.33141198e-01,-2.70359659e-01, 1.20065510e-01,
  -1.85038193e-01,-1.26476184e-01,-2.73569280e-01, 1.03380985e-01,
  -1.61745374e-01,-4.19829191e-01, 5.28722803e-01, 2.34584008e-01,
  -1.47658582e-01, 3.82721735e-01,-8.20287230e-01,-1.38760075e-03,
  -5.74982837e-02, 3.15618162e-01],
 [ 3.68278771e-01, 5.87863119e-01, 5.70177094e-02,-3.64746545e-01,
  -2.42671095e-01,-2.54313708e-01, 8.67916462e-02,-6.75515941e-02,
  -2.37512366e-01, 2.78442891e-01,-1.89772215e-01, 7.54101814e-02,
  -4.63091319e-02,-2.73370767e-01,-2.72104116e-01, 9.41764906e-02,
  -3.21735855e-01, 1.95366563e-01],
 [ 6.63507612e-01, 4.45305398e-01, 6.67715527e-03,-3.96148320e-03,
  -7.50300697e-04,-2.78142175e-01, 1.10911100e-01, 1.95056053e-01,
   2.62110797e-01,-4.69302229e-02,-1.79037155e-01,-2.24315948e-01,
   7.12088772e-01, 9.07208982e-03,-5.47980913e-01, 3.26719931e-01,
  -4.93797234e-01, 8.40674823e-02],
 [-7.95047726e-02,-1.92875334e-01,-7.19827019e-01,-2.70395917e-01,
   2.92852525e-01,-7.02361295e-02, 2.19775687e-01, 3.97911779e-01,
   4.68140182e-01,-3.12839210e-01,-7.36363375e-02, 6.90116906e-02,
   3.83594205e-01, 1.51598359e-01, 5.09122058e-01, 2.32563080e-01,
  -1.81008423e-01, 2.82483244e-01],
 [ 4.72389174e-02, 1.87243597e-01, 4.40083762e-01, 5.97402290e-02,
   3.42240382e-01,-2.11662042e-02, 1.49619024e-01,-3.41441518e-01,
  -3.11569358e-01,-2.05901581e-01, 1.64909389e-01,-3.50965340e-01,
   2.42207325e-02, 2.39919439e-01, 3.08402195e-01,-5.46542158e-01,
   6.84890386e-01, 2.42948398e-01],
 [ 5.66264640e-02,-4.32153869e-02, 2.49672196e-02,-1.40064327e-02,
   3.55444006e-01, 6.00408455e-01,-2.07278581e-01, 3.45285189e-01,
   6.24286130e-01,-1.28854291e-02, 8.27674330e-02, 3.60684266e-01,
  -2.67075382e-01,-9.52582434e-02,-1.42414857e-01,-4.71246242e-01,
   1.08434068e-01,-2.50758429e-01],
 [ 2.90620744e-02, 3.40050044e-01,-1.23548571e-01,-6.27197203e-02,
  -2.77132912e-01,-4.83968510e-01,-1.30843543e-01,-4.17890770e-01,
   4.62558640e-01, 7.42578981e-03,-2.45321955e-01,-1.03978377e-01,
   4.96664810e-02,-4.35476328e-01, 7.37996249e-02,-3.63228872e-01,
   3.15691574e-01,-3.85415130e-01],
 [ 1.27092873e-01, 2.51218708e-01, 1.67627506e-01, 3.61265280e-01,
   2.28147987e-02, 8.31324978e-02,-3.56931554e-01, 4.75054594e-02,
   1.05185579e-01,-5.46110810e-03, 5.50523890e-02, 5.49494501e-01,
   2.91659471e-01,-2.54941868e-02,-1.47115933e-01, 6.84849422e-01,
   2.07622876e-01,-7.50654025e-02],
 [ 2.64580892e-01,-1.61647869e-01, 8.28121970e-01,-3.17503678e-01,
   4.57791666e-01,-1.24178700e-01,-1.57149564e-01, 3.17183247e-02,
   3.45357922e-01,-4.36823909e-03,-9.82214910e-02,-8.80463515e-03,
   1.63391916e-01, 2.78046362e-01,-2.23963242e-02,-1.30349392e-01,
  -1.55854841e-01,-4.85001727e-01],
 [-8.22116765e-02,-7.28108863e-02,-1.51922469e-01, 6.95691773e-02,
  -2.20055887e-01, 1.24869683e-01,-2.89427545e-01, 4.54101459e-01,
   7.56544543e-02,-4.03282530e-01,-1.38835980e-01,-2.56499309e-01,
   3.82989828e-02, 4.23001291e-01,-4.89509379e-02,-9.68381952e-02,
   3.40939442e-02, 7.30160335e-01],
 [ 4.77093358e-01, 6.46939670e-01,-1.41929344e-01, 1.14190776e-01,
   1.03189247e-02, 7.57889979e-02, 2.00183911e-01,-3.93544984e-01,
   4.08965609e-01, 8.31431173e-02,-2.17064671e-01, 3.29199001e-01,
  -3.15537906e-01, 4.00875990e-02,-4.50768978e-02, 1.35767775e-01,
  -2.27286037e-01, 4.68125836e-02],
 [-2.16546223e-01, 7.14670673e-02,-2.51922793e-01,-7.49145134e-01,
  -3.02208397e-01, 4.09323072e-02, 4.36048028e-01, 2.01575414e-01,
   3.15615789e-01, 1.71735028e-01, 1.90251741e-01,-2.38169653e-01,
  -9.80407028e-02,-4.25711310e-01, 2.36435580e-01, 4.25857973e-01,
   5.84591735e-01, 6.03035922e-02],
 [-8.42391981e-01, 3.73432065e-01, 1.17283128e-01, 4.09908124e-01,
   2.35329706e-01,-2.35996395e-01, 4.05800338e-02,-3.02146522e-01,
   5.85361371e-01,-2.45594697e-01, 1.69376452e-01, 1.97224109e-01,
   2.65530853e-01, 6.00839403e-01,-5.51976977e-02,-2.99441377e-01,
   5.15460325e-01, 7.96390984e-02],
 [-1.45367211e-01, 4.28933035e-01, 5.36419851e-01,-2.29583185e-01,
   4.08581165e-01,-1.98860566e-01,-5.51413144e-01, 2.11432807e-01,
   4.60097846e-02,-2.70884809e-01,-3.41441595e-01, 1.21956799e-01,
   6.90747509e-02, 2.46751344e-01, 2.21967748e-01,-9.64860778e-03,
  -3.34932776e-02, 4.06917797e-01],
 [ 3.82488907e-01, 1.81689069e-01,-4.41265291e-01, 2.42719456e-01,
  -6.91852119e-01,-1.59448662e-01, 4.14771712e-01,-3.79025242e-01,
   2.37391959e-01, 1.75367958e-01,-9.61404306e-02, 2.88043133e-02,
  -2.31857721e-03, 2.82992696e-01,-2.63355832e-02, 1.56597439e-01,
   5.53352172e-02,-1.79515428e-01],
 [ 5.11014196e-02,-1.18273800e-01,-1.23885001e-01, 1.12185080e-01,
  -8.76474035e-02,-2.64146630e-01, 5.56566809e-02, 1.78732646e-01,
  -5.07978473e-01,-4.87792197e-01,-7.02481371e-01,-7.23622287e-01,
   2.45513915e-01,-1.28199443e-02, 5.71319893e-01,-2.88504670e-02,
   3.97950190e-01,-4.79646877e-02],
 [-6.05830340e-01, 1.38309828e-01, 2.33385184e-01,-1.19800193e-01,
   5.13069737e-02, 2.72009120e-01, 5.28597141e-02, 4.77645544e-02,
  -2.01530956e-01,-3.71324933e-01, 1.75480208e-01, 1.48145376e-01,
  -7.42238674e-02,-2.77193635e-01,-4.30873584e-01,-3.74395245e-01,
   2.81084373e-01, 3.98486493e-01]],
[[-5.22656525e-01,-6.30598975e-01, 2.04130029e-01,-2.82878618e-01,
   1.12157712e-01,-5.72833787e-01,-2.87966494e-01, 3.21584601e-01,
  -7.29664348e-01, 8.42155357e-02,-2.66671721e-01, 8.90223309e-03,
   1.14399472e-01,-3.08033486e-01, 5.66694170e-01, 1.38077808e-01,
  -5.47122595e-02, 3.22588237e-01,-7.02042861e-01, 3.97872732e-02,
   2.94475095e-01,-4.27249819e-01],
 [-4.11514393e-01, 4.00370286e-01,-5.95245060e-01,-2.41208665e-01,
  -8.76637445e-02, 6.86661559e-02,-1.81861161e-02,-3.84760548e-01,
   4.12268686e-01, 1.47634355e-01,-2.42530773e-01,-1.76588877e-01,
  -4.91251436e-01, 2.04512078e-01, 6.75825212e-03,-7.32247829e-02,
   3.85920899e-01, 8.61421855e-02,-5.60891587e-02,-4.75697240e-02,
  -2.59321068e-01,-3.94704997e-01],
 [-2.12754844e-01, 7.77649949e-02,-5.41928376e-01,-1.61791461e-02,
  -2.55541521e-01,-1.28752812e-01,-2.23954739e-01,-2.64881554e-01,
   7.41258282e-02,-5.40819948e-02,-1.79767051e-01, 5.04821121e-01,
  -7.97248516e-02, 2.23469439e-01,-2.16229395e-01, 2.30840154e-01,
   1.99304430e-02,-2.27158597e-01,-2.72353376e-01,-4.60536022e-01,
   1.16271579e-01, 2.32129183e-01],
 [ 3.37567463e-01, 5.84929830e-02,-8.45859423e-02, 4.73797206e-01,
  -4.34377721e-01,-3.31094168e-01,-2.41488765e-02,-5.26193581e-01,
   3.98913559e-01, 6.08436228e-01,-6.53022707e-02,-1.28765574e-01,
   3.44287216e-01,-2.87067152e-01,-7.05038681e-01, 1.41760597e-02,
   4.95624477e-01,-3.41690929e-01,-5.28882944e-01, 6.75662940e-02,
   2.96109408e-01, 1.99705198e-01],
 [ 9.82438099e-02, 1.13611196e-01, 1.94125156e-01,-4.11474189e-01,
   1.84844297e-01, 3.03977910e-01, 1.45855387e-02,-6.29132582e-01,
   1.51438911e-01, 1.78304102e-01,-1.96966247e-01, 3.54062931e-01,
  -2.06371719e-01,-3.90763906e-03,-2.11005030e-02,-3.56612139e-01,
  -2.76678964e-01,-1.97713416e-01,-6.47572029e-01, 6.90257971e-02,
  -8.51884707e-01,-1.85352660e-01],
 [-3.69540272e-01, 6.90191586e-02, 3.53987261e-02,-4.15700644e-01,
   2.33118745e-02, 4.27696820e-03,-7.25918530e-02,-2.29553663e-01,
   4.39029229e-01,-3.23188535e-02,-4.30235377e-01, 4.95287720e-01,
   5.68898085e-01,-4.30814326e-02, 5.35069234e-01, 2.89587983e-01,
   9.17106828e-02,-1.19656157e-01,-6.10508868e-01, 3.59045846e-01,
   2.26879628e-01,-3.52424866e-01],
 [-3.82462317e-01,-7.25789475e-02, 5.71268177e-02, 1.05903992e-01,
   3.55303959e-01,-2.34555855e-01,-4.48730680e-01,-1.33328779e-01,
   2.46190362e-01,-7.39819254e-01, 4.77467565e-01,-1.41870770e-03,
   4.21813739e-01,-2.81834636e-01, 1.89345903e-01, 3.48406328e-01,
  -1.35379847e-01, 4.85588398e-01, 4.55668470e-02,-1.68329706e-01,
  -2.58962083e-02, 1.91921258e-01],
 [-1.60981211e-01, 3.17583416e-01,-4.26673166e-02,-6.82564376e-01,
  -9.02673793e-03,-4.20241959e-01,-3.71789914e-01,-3.70198687e-02,
   2.02290214e-01,-1.57631330e-01, 4.86038438e-02,-1.25378806e-02,
  -7.79525779e-02, 1.49377168e-01,-3.31686304e-01, 3.32279202e-01,
   6.55591675e-02, 1.41690321e-03,-4.30792581e-01, 6.63459312e-02,
  -4.71315429e-01,-3.59668794e-02],
 [-4.78985481e-01,-1.39128655e-01, 6.21379927e-01, 2.35900750e-01,
   4.28262958e-01, 5.16697147e-01,-6.49452583e-01,-6.97757153e-01,
  -4.33325748e-01, 5.08182106e-01,-4.99863805e-01, 8.41575257e-02,
   2.63473251e-01,-4.36542610e-01,-6.20525480e-01,-4.32020301e-01,
  -1.21456821e-02, 2.09225589e-01,-1.12891030e-01, 5.87335952e-02,
  -2.53872234e-01, 2.46082294e-01],
 [ 5.86950718e-01, 6.38137505e-02,-1.46203220e-01, 3.61434853e-02,
  -1.15336343e-01,-1.56032826e-01, 6.68596731e-01, 2.14718153e-01,
   3.88882948e-01,-2.70935442e-02,-9.02489150e-02,-4.64012398e-01,
  -7.48314103e-01,-2.14787324e-01, 2.12570885e-01, 5.50056138e-04,
  -4.07784997e-01, 1.20488725e-01, 5.26566451e-03,-2.47249071e-01,
   3.93474446e-02,-1.33785494e-01],
 [ 4.69957851e-01,-2.78340750e-01, 4.51465719e-02, 2.59657893e-02,
   1.56784647e-01,-2.72827077e-01,-1.84071546e-02,-8.65765697e-02,
  -5.15083250e-01, 3.36542677e-01,-1.81125322e-01, 1.18007910e-01,
  -4.72219487e-02, 5.46567279e-02, 2.15604775e-01,-8.40129293e-02,
   8.83403381e-02,-1.49411298e-01, 2.16737354e-01,-3.32538484e-01,
  -2.21776860e-01,-5.05778856e-02],
 [-1.43901525e-01,-1.72697705e-01,-2.46273463e-02,-2.00834172e-01,
  -3.37002638e-02,-6.29222130e-02, 1.96131479e-01, 3.25733705e-01,
   7.84279779e-02,-3.92370438e-01, 9.84368932e-02, 2.13864280e-01,
   1.38504678e-01,-9.57913958e-02, 3.85237801e-01, 1.73603741e-01,
   3.61399931e-01,-4.01471615e-01,-9.02015134e-02, 2.92039257e-01,
  -2.69088800e-01, 4.89152616e-02],
 [ 2.18354530e-01, 7.34495410e-01,-2.80536439e-03, 5.23414576e-01,
  -2.38835316e-01, 5.15981271e-01,-4.64170275e-02,-9.00925166e-02,
  -2.76911573e-01, 1.17240813e-01,-2.90843202e-01,-2.54087210e-01,
   5.29140375e-01, 1.87041621e-01, 3.24159477e-02, 1.04946357e-01,
  -5.20804384e-02,-1.73357725e-01, 7.98400875e-01, 3.81315350e-02,
   1.77287977e-01, 2.73499738e-01],
 [-3.71951984e-01,-4.00514955e-02, 6.12953531e-02,-5.28940648e-01,
  -2.38653701e-01, 2.70190076e-01,-5.86566419e-02, 5.50871057e-01,
  -5.43667369e-01, 3.38969070e-01,-3.14746152e-01, 1.94566764e-01,
  -4.93667567e-01, 2.99428847e-01,-6.53129738e-01, 8.51061384e-02,
   5.87940509e-01, 5.18202535e-02, 9.93001719e-03, 1.91617099e-01,
  -1.56327960e-01, 4.02131966e-02],
 [-1.50914257e-02, 2.63035147e-01, 2.26502540e-01, 1.53011255e-03,
   6.97985310e-01, 3.90536469e-01,-1.48839325e-01,-1.85962548e-01,
   4.45534505e-02,-6.28733657e-01, 7.45177957e-01,-9.40400629e-02,
   7.94854210e-02,-3.23895181e-01, 5.13295136e-01,-5.36186693e-01,
   3.22426546e-01,-4.30323213e-02, 3.17036531e-01,-3.84038374e-02,
   8.66274292e-02,-2.61652190e-01],
 [-8.43093076e-02,-1.89949892e-01, 3.34260029e-01, 1.48585801e-01,
   2.98848712e-03,-1.87099237e-02,-4.04206805e-02, 6.63338319e-02,
   1.64277398e-01,-1.22774172e-01,-4.10583343e-02, 2.44237709e-01,
   5.00241057e-02, 1.06904827e-01, 2.81942778e-03, 1.63196460e-01,
   1.35870114e-01,-4.01380068e-01,-1.83919745e-01,-3.12258153e-01,
  -1.92521968e-01, 3.21843656e-01],
 [ 2.59553641e-01,-2.02635315e-01,-3.32472550e-02, 2.31849650e-01,
  -6.74790955e-01,-1.87804030e-01, 3.29666728e-01, 3.24466222e-01,
   1.62393160e-01,-2.43079480e-01, 2.08278969e-01,-2.19151423e-01,
  -1.00326590e-01,-9.74104476e-02, 5.94125977e-02, 1.34666410e-01,
  -1.11434765e-01, 7.26427897e-01,-5.26565697e-01,-1.18243117e-01,
   2.22691115e-02,-2.34621440e-01],
 [-1.04778850e-01, 2.44136292e-01, 3.49249982e-01, 1.33542086e-01,
  -2.66871802e-02, 3.55698799e-01, 5.30020050e-01,-3.27992832e-01,
  -3.62835131e-01,-1.44723379e-01,-4.74641395e-01,-6.95317449e-02,
   3.45809862e-01, 2.08738380e-02, 3.37896873e-01, 8.50341780e-01,
  -1.82717110e-01,-3.78325855e-01,-1.32228720e-01, 3.25526415e-01,
  -9.41001779e-02, 3.02987672e-01],
 [ 1.86817609e-01,-9.98950446e-02, 2.95578073e-01,-4.10784584e-01,
   5.68611093e-01, 2.37482210e-02, 2.22380965e-01, 3.81289177e-01,
  -8.24226855e-02, 2.33042660e-01,-1.07913463e-01,-5.19652663e-01,
   2.08481350e-01, 5.90151494e-02, 2.83207515e-01, 2.05677020e-01,
   1.48659672e-01, 3.58495117e-02,-3.62339886e-01, 3.81876970e-02,
  -2.09729372e-01, 1.94435741e-01],
 [-1.34646198e-03,-9.19168540e-01,-1.69204861e-01,-9.17837000e-02,
  -4.83400629e-01, 4.13103797e-01, 3.05678133e-01, 8.36557821e-03,
   3.72812066e-01,-4.49425499e-01, 1.88637790e-01, 4.27458751e-01,
   1.38181932e-01,-1.43907061e-02,-2.99870107e-01,-5.25779972e-02,
   6.66195241e-02, 3.80301732e-02,-1.06535575e-01, 1.02411564e-02,
   2.65529172e-01,-3.16186612e-01],
 [ 8.95872149e-02, 3.57410457e-01,-2.72910228e-01, 2.77445495e-01,
  -5.27899743e-01,-6.16287147e-01,-3.94953260e-01, 8.36065451e-02,
   2.02248855e-01,-2.06975847e-01, 1.62610947e-01,-1.86975500e-02,
   7.66799883e-02,-8.99493331e-01,-3.70515227e-01, 6.19239293e-01,
   3.87154062e-01,-6.33631109e-01,-4.60873486e-01, 1.92853214e-01,
  -2.20856711e-01, 4.93253214e-01],
 [ 9.78318837e-02,-2.75292375e-01, 6.50487008e-01,-2.49511619e-02,
   3.29948980e-01,-8.69172541e-03, 4.76158722e-01,-2.67566602e-01,
  -4.30044979e-01, 2.89095527e-01,-1.68543561e-01, 1.04685315e-01,
  -3.43079465e-02, 4.64023827e-01,-8.72568108e-02,-1.12632287e-02,
  -2.75126791e-02, 1.68222920e-01, 3.20058726e-01,-1.27843947e-02,
   4.56733202e-02, 3.83826578e-01],
 [-4.08004299e-01, 2.77350535e-01, 3.36422384e-01,-4.33980596e-01,
   3.13898019e-01,-3.92080349e-01, 9.60596381e-02,-1.63915747e-02,
   2.36921351e-01, 2.83533347e-01, 2.78032006e-01,-4.14347071e-01,
   3.26631647e-01,-1.64871855e-02,-7.52427304e-01,-1.39998039e-02,
  -8.34536259e-01, 2.14083002e-01, 4.72888471e-02, 1.59175456e-01,
   5.49108594e-01,-9.40970082e-02],
 [-2.52690313e-01, 3.40625252e-02,-5.79583986e-01, 4.47612625e-01,
   1.07818958e-01, 7.20057177e-01, 7.50129379e-02, 5.60760217e-01,
   3.84859376e-01, 2.62543800e-01, 3.23782153e-01, 3.27719007e-01,
  -4.02315401e-01,-8.85300327e-02, 1.56286872e-02,-5.43648257e-02,
   6.25804583e-02,-1.66667843e-01,-2.31894907e-01, 2.36299917e-01,
  -2.38969025e-02, 3.48790297e-01]],
[[-3.61806873e-01,-3.04520932e-01,-4.44989193e-01, 1.90012318e-02,
   2.07014257e-01,-2.86443205e-01,-9.46446897e-01,-1.35904598e-01,
   9.79538728e-02, 1.74991309e-02,-2.63050212e-01, 9.90545154e-03,
   4.65372294e-03,-7.89664883e-01, 6.39259492e-01,-4.43568058e-02,
   3.46632910e-01,-1.12225121e-01,-2.87196996e-01,-5.39343773e-01,
  -1.33871649e-01, 8.74585303e-02,-2.02810890e-01, 2.44033873e-01],
 [-3.37004614e-02, 3.10199663e-01,-9.42551751e-02, 3.81942638e-01,
   3.51090314e-01,-3.40880694e-01,-9.28786602e-02,-1.44810704e-02,
  -3.03620162e-01,-3.75848643e-01,-1.97705300e-01,-3.31168639e-02,
   2.20416134e-01, 8.32798876e-02, 1.30748404e-02,-3.70639386e-02,
   6.04487669e-02, 8.10768310e-01, 3.35710678e-01, 6.25464807e-01,
   4.15575501e-01,-4.11581085e-01,-5.97154575e-01,-1.83243887e-01],
 [-7.05848558e-03,-2.03331006e-02, 3.16749082e-01, 2.86393583e-01,
   2.05408109e-01, 4.69710651e-01,-3.66842291e-01,-2.28048704e-01,
  -1.89517235e-01, 2.03982885e-01, 1.88097220e-01,-3.59570772e-01,
   3.27022917e-02,-2.99842128e-01, 2.11672899e-01, 9.53086835e-02,
  -6.29158758e-01,-7.01617092e-02,-3.26260129e-01, 2.34564043e-03,
  -3.37533026e-01,-1.28289325e-02, 8.13049071e-03, 2.22476107e-01],
 [ 6.63138856e-03,-1.10254985e-01, 1.02767342e-01, 2.38471639e-01,
  -1.73375315e-03, 2.03237656e-01, 2.45549527e-01,-2.96752609e-02,
  -1.27584681e-01,-2.85847184e-01, 1.82116570e-03,-1.74522630e-01,
  -2.05925534e-01, 6.58642926e-02,-7.32558331e-02,-5.10548983e-01,
   3.45668268e-01,-4.02137694e-01,-1.49772744e-01,-4.58121115e-02,
  -7.18394952e-02,-2.66101068e-01,-9.54540363e-02, 1.79132011e-01],
 [-2.73252547e-01,-1.91579972e-01, 1.88083914e-01,-3.71031916e-01,
   1.32363845e-01,-3.63416005e-01, 6.07129186e-02,-1.10669651e-01,
  -1.31960593e-01, 2.34874814e-01, 6.92832857e-02,-1.26572422e-01,
  -1.88459670e-01, 2.26617828e-01,-7.64395029e-02,-1.30225835e-01,
   3.22379604e-01,-3.00548033e-01, 4.93685101e-02,-3.58082156e-01,
   7.42701940e-01,-3.90617975e-02, 1.80441211e-01,-1.80936457e-01],
 [ 3.70012488e-01,-1.48047218e-01, 2.94486690e-01, 1.24768373e-01,
   3.21815370e-01, 2.88085632e-01, 2.88117170e-02, 2.60844169e-02,
  -3.73720732e-02, 3.48436558e-01, 7.09107395e-01,-3.24223254e-01,
  -2.68192530e-01,-2.07995022e-01, 2.04017865e-01,-6.06230355e-02,
  -1.23295218e-01,-2.45695927e-01,-6.04405984e-01,-2.46607079e-02,
  -6.94618247e-01,-2.27960796e-01, 1.07301820e-01, 6.42527994e-02],
 [ 7.28324669e-02, 2.08009742e-01, 2.43833721e-01, 5.81759021e-01,
  -4.23341761e-01,-3.07165643e-02,-1.63678154e-01,-3.50671177e-01,
   4.63448258e-01,-2.95462356e-01, 3.14693914e-01,-5.12722481e-01,
   2.45228758e-01, 1.85988773e-02,-3.39355109e-01, 7.45365787e-02,
   2.09995133e-01, 2.43528337e-02, 3.66110091e-01,-3.77816096e-02,
  -1.48081525e-01, 1.91190452e-01,-5.53450490e-02,-2.47179919e-01],
 [ 2.82768595e-01,-2.61365813e-01,-6.30109354e-01,-5.48352504e-02,
  -2.16905103e-01,-1.43444004e-01,-3.68873419e-02, 1.51188244e-01,
   7.36895613e-02,-1.54988993e-01,-1.40063499e-02,-1.93404833e-02,
  -3.60203728e-01, 5.52434548e-01, 5.49210700e-01,-4.23864537e-01,
  -1.19665229e-02,-1.69300813e-02,-1.99275893e-01, 2.35357708e-01,
  -2.06855080e-01, 4.62879479e-02,-4.83853842e-02,-4.30139352e-01],
 [-7.67471541e-01,-1.79807328e-01, 3.01594600e-01,-4.83164428e-01,
  -1.36513723e-01,-3.00474642e-01,-1.09372293e-02, 1.86437272e-01,
  -2.54880876e-01, 8.90311201e-02, 1.78110265e-01, 4.66957085e-01,
  -1.13983920e-01,-1.50914948e-01, 6.82970136e-02, 3.54667506e-01,
   5.88564432e-02,-2.58458738e-01,-1.29534654e-01, 3.60365412e-01,
   6.13740400e-01,-6.27290010e-02, 3.17907027e-01,-1.72792999e-01],
 [ 7.98906574e-02, 1.80031881e-02, 2.34844719e-01,-6.37150730e-02,
  -2.95529061e-01, 1.95219494e-02,-3.41394341e-01,-3.12473048e-01,
  -1.99208021e-01, 4.46415063e-01, 6.49315261e-02,-4.77661510e-02,
  -5.01811445e-01,-1.24910432e-01, 8.66697628e-02, 5.53139859e-01,
  -4.67517927e-01, 4.89988278e-02, 1.55965274e-01,-1.46472961e-01,
   2.33444990e-01,-1.65053769e-01,-2.76593861e-01,-4.18254118e-01],
 [-6.84679557e-02,-2.58183497e-01, 6.68089504e-01, 3.98927697e-01,
   1.41003821e-01,-1.87042726e-01,-3.67283142e-01, 9.00495783e-02,
  -2.78970523e-02, 2.30764967e-01, 2.92240601e-01, 2.00713923e-01,
  -7.93115929e-01,-6.40470334e-01, 1.95944325e-01,-1.77032631e-01,
   2.50427454e-02,-2.25311240e-01, 1.30529354e-01, 1.89996784e-01,
   1.58578440e-01,-5.04402301e-01,-3.61010699e-01, 3.39215092e-01],
 [ 2.05513888e-01, 1.55970043e-02,-1.64538180e-01,-7.70044250e-01,
  -6.48897608e-01, 1.68448927e-01,-3.27354999e-01, 1.67909212e-02,
  -3.84086814e-01,-1.20031537e-01, 2.70432202e-01,-1.06949429e-01,
   8.27687648e-04, 9.31988833e-02, 3.14922032e-01, 5.96569530e-01,
   1.85421869e-01,-3.71888592e-01,-1.36032201e-02, 2.01246437e-01,
   5.27854447e-02, 1.17776867e-01,-7.58555869e-02,-5.81851253e-02],
 [-3.01819489e-01,-1.67580115e-03, 3.67162305e-02, 2.45701395e-01,
  -1.10411974e-02, 2.15737424e-01, 7.43921821e-02, 4.01464192e-01,
   8.35630343e-02, 3.28915476e-02,-1.65206226e-01,-9.72032657e-01,
   4.73663516e-02, 2.20753582e-02,-1.88746655e-03, 1.23837621e-01,
   3.47355071e-01, 2.21527948e-01,-3.74642077e-01, 1.09478954e-01,
   1.56035800e-02, 2.64142140e-01, 1.91365436e-01,-5.10214464e-01],
 [ 2.88457686e-02, 2.12518155e-01, 3.26760656e-01,-2.77835708e-02,
   1.92781411e-02, 3.61358968e-01,-3.98097633e-01,-4.41119280e-01,
  -3.72628908e-01,-3.24384714e-02,-2.14457879e-01, 4.50643856e-01,
   4.08801458e-02,-2.33440735e-01, 9.78424353e-02,-3.45363091e-01,
   1.02251575e-02,-4.13576240e-01, 2.30743106e-01,-3.81369601e-02,
   2.38243020e-01, 7.95908233e-01,-9.55556583e-02,-2.53467882e-02],
 [ 1.02471459e-01, 1.39807841e-01,-2.29038965e-01,-6.73341215e-01,
   1.58198366e-01, 1.38213548e-01, 2.04553378e-01, 2.42991223e-01,
   7.01566590e-01,-2.10598598e-02, 5.27333311e-01, 2.95505169e-03,
   3.67457931e-01, 1.17680758e-01, 2.49541238e-02, 1.85888141e-01,
  -6.78845027e-01,-5.66409506e-01, 6.21917199e-02,-2.18054830e-01,
  -1.00000711e-01,-9.62685335e-02,-3.30897902e-02, 2.31358268e-01],
 [-1.70138695e-01,-4.68633462e-01, 4.05917419e-01, 3.83462259e-01,
   1.36109155e-01,-2.54041400e-01,-4.43367217e-01, 1.44493659e-01,
   3.13497417e-01, 1.25302352e-01,-2.38174336e-02, 3.41702302e-01,
  -2.70153344e-01, 7.37789467e-01,-5.55614336e-01, 1.60219273e-02,
   1.10153715e-01,-4.52801309e-01,-5.94430198e-02,-3.99178479e-01,
  -4.09526642e-02, 1.03304308e-01, 2.71131767e-01, 4.03985326e-01],
 [ 3.55222123e-01, 2.04781409e-01,-2.93038496e-01, 3.59430867e-01,
  -6.31834249e-02,-7.65570294e-01, 1.27033508e-01,-1.72389294e-01,
   7.55247332e-02,-4.41895032e-01, 1.30055909e-01,-3.84300109e-02,
   4.04054189e-01, 2.72528869e-01, 9.62523981e-02,-2.98795461e-01,
  -2.82483146e-02,-8.95827341e-02, 7.35287916e-02,-2.71093829e-01,
  -1.82448376e-01, 5.52512515e-02,-2.68861731e-01, 3.08425794e-01],
 [-3.06442269e-01,-2.51309944e-03,-2.48728864e-01, 1.34768311e-01,
   1.15502831e-01,-2.55667399e-01, 5.87649056e-02, 7.62629851e-02,
   3.42192882e-01, 2.53797678e-01, 2.99461609e-02,-7.58160215e-02,
   2.60010287e-01, 3.50425287e-01,-3.50205548e-01, 2.37276090e-01,
  -6.88429173e-02,-5.28368531e-01, 2.25536210e-01, 9.83875751e-02,
   2.15681528e-01, 2.71803201e-01,-2.96177216e-01, 2.71143197e-01],
 [ 1.16527022e-01,-2.90506606e-01,-1.16455212e-01,-3.30444678e-01,
   5.68057362e-02, 4.18862897e-01, 6.58119891e-01,-6.78416542e-01,
   1.85139129e-01, 3.22005422e-01, 1.74690461e-01,-3.63847491e-01,
  -1.33794384e-01,-3.41718488e-02,-1.95766780e-01,-1.82643442e-01,
  -2.92168005e-01, 3.28547664e-01,-3.90871922e-01, 2.04854205e-01,
   2.44968029e-01,-8.32612707e-02, 3.71513740e-01,-3.46720392e-01],
 [-2.12873706e-01, 5.27493267e-03, 1.80075228e-01,-1.30688780e-01,
  -5.03857381e-01, 2.89754565e-01,-2.63975350e-01, 3.37392018e-01,
  -2.29143467e-01,-4.07634766e-01,-1.32839477e-01, 4.14035197e-01,
  -2.15316913e-01, 2.86214658e-01, 1.50968909e-01,-5.44524908e-01,
   1.67084927e-01, 3.65607748e-01,-6.09423448e-02,-5.66937582e-01,
   9.98539504e-02, 4.67289800e-01, 2.59152362e-02,-2.57430899e-01],
 [-1.89995660e-01,-6.13514695e-01,-1.03223485e-02, 2.28917819e-01,
   2.73842117e-01,-1.98810815e-01,-2.15636599e-01, 4.93477511e-02,
   5.49415987e-01,-1.06676527e-01, 2.63252279e-01,-5.25683144e-01,
   3.06498515e-01,-6.09740550e-01, 6.39746950e-02,-2.87782587e-01,
   2.65679464e-01, 3.48357854e-01,-1.26069021e-01, 5.99690959e-02,
   2.26793109e-02,-3.15298060e-01,-6.51313377e-02,-1.81518644e-01],
 [ 1.87417294e-01, 4.08115478e-01,-4.00256127e-01,-2.81579006e-01,
  -6.07892013e-02,-2.92194518e-01,-3.48866696e-01,-4.29016829e-01,
  -3.03088261e-02, 2.71531642e-01,-2.76469880e-01,-2.00985102e-01,
   1.31670062e-01,-3.55005638e-01,-7.78498781e-02, 1.20624570e-02,
   2.48142492e-01, 7.45825470e-01, 3.93179528e-01, 9.30900478e-02,
  -3.14836926e-01, 1.23069274e-01,-1.74414990e-01,-2.24944158e-01],
 [-1.04870493e-01, 3.14191833e-01,-6.31240921e-02, 4.36301052e-02,
   2.06088753e-01, 2.40203048e-02,-3.59593727e-02,-2.44957753e-01,
  -5.06783909e-02, 2.85110811e-01, 1.13689668e-01,-5.50987771e-01,
  -2.38722833e-01,-1.80226802e-01,-3.61294820e-01,-4.35403555e-01,
   1.34340743e-01, 6.11724942e-02, 2.94123589e-01, 1.66646760e-01,
  -4.02469384e-01,-1.37447195e-01, 7.73952429e-02,-3.29200836e-01],
 [-7.58726460e-01,-4.11352385e-02,-2.58710439e-01, 4.33334358e-02,
  -1.30630034e-01,-1.68492417e-01,-6.85550579e-02, 5.08118406e-02,
  -3.17240014e-01, 5.29615752e-02, 3.33436234e-02, 1.73439633e-01,
  -1.26390403e-01,-5.74375370e-02, 2.26328785e-01, 6.86910050e-01,
  -2.26097438e-01,-2.60638801e-01, 2.86231585e-01,-2.09114927e-01,
  -1.12271343e-01, 2.19438214e-01, 8.69104657e-02,-5.62002272e-01],
 [ 2.38916363e-01, 1.47770065e-01,-6.35141253e-02,-2.02485366e-01,
  -2.53596251e-01, 2.21635955e-01, 2.15466874e-01,-4.71576428e-01,
  -2.67576692e-02, 1.93426703e-01,-4.15644797e-02, 8.71042880e-02,
   1.10815319e-01, 3.11638570e-01, 3.82831011e-01,-1.35107822e-01,
   7.01704569e-02, 1.19645117e-01, 3.35320926e-01,-2.56970274e-01,
   3.80189551e-01,-1.22345876e-02, 2.07204500e-01,-3.30720278e-01],
 [ 4.75269626e-01,-1.57438682e-01, 2.94608485e-01, 7.32742779e-01,
  -2.43230206e-01, 1.06895579e-01, 3.23737866e-01,-3.54653149e-01,
  -6.03648108e-01, 3.10642454e-02, 8.56347010e-02,-5.96190451e-01,
   2.62381189e-01,-1.47334460e-01, 1.25705968e-01,-1.45894975e-01,
   3.24660493e-01,-3.33762820e-01,-2.14791855e-01,-3.73345033e-01,
   2.40448709e-01,-4.71984551e-01,-2.60532370e-01, 2.08752371e-01],
 [-8.22663861e-02, 6.93278193e-02, 3.59607804e-01,-8.02218018e-02,
  -4.18473329e-02, 3.22329294e-01, 3.11202836e-01,-2.37086355e-01,
   1.76851962e-01,-1.07320008e-01, 3.50150070e-01, 4.64468482e-02,
   5.52528428e-02, 4.30920930e-01, 1.33474048e-01,-1.24668582e-01,
   2.80881440e-01, 2.25471262e-01, 1.88902692e-01,-2.53891853e-01,
  -1.22255137e-01, 4.54998103e-01,-1.06742970e-01,-3.74191223e-02]]
]
        biases = [
[-0.00410759,-0.06545799, 0.01954774, 0.03032717, 0.00378299,-0.01234812,
  0.12080454, 0.01369957,-0.0017538 , 0.0450524 , 0.0016827 , 0.03259117,
 -0.1464338 ,-0.01104968,-0.0704448 ,-0.06794887,-0.04378094,-0.05358255,
  0.00801645,-0.03419578, 0.03493037, 0.11021805],
[-0.06805385, 0.0108887 , 0.06998183, 0.06827776, 0.02980012,-0.05714434,
  0.03646627,-0.0651203 ,-0.07440213, 0.00714126,-0.0167814 ,-0.03019138,
  0.02753595, 0.01702993, 0.14010333,-0.15675039, 0.0362951 , 0.04718776,
  0.02436276,-0.03264947,-0.0792828 , 0.0687787 ,-0.03056827,-0.06059592],
[ 0.00545632,-0.07526091,-0.05185787,-0.02425098,-0.03223101, 0.15404277,
  0.09860587, 0.02523459,-0.07646221, 0.09412224,-0.03021751, 0.05788786,
 -0.05738881,-0.01528409, 0.00269158, 0.06547659, 0.00968672, 0.07394189,
  0.12696061,-0.01465442, 0.08701864, 0.04726948, 0.02731345, 0.01958971,
 -0.19378767,-0.01007823,-0.07250102]
]

        self.neural_network = NeuralNetwork(
            weights,
            biases,
            activiation_functions
        )

    def play(self, player_state, opponent_state,
             player_score, opponent_score,
             turn, length, pip_count):
        player_state = numpy.array(player_state)
        opponent_state = numpy.array(opponent_state)

        # Sum each column, row, and grid
        column_sums = numpy.ravel(
            [player_state.sum((0, 1)), -(opponent_state.sum((0, 1)))], "F"
        )
        row_sums = numpy.ravel(
            [player_state.sum((0, 2)), -(opponent_state.sum((0, 2)))], "F"
        )
        grid_sums = numpy.ravel(
            [player_state.sum((1, 2)), -(opponent_state.sum((1, 2)))], "F"
        )

        nn_inputs = numpy.concatenate((column_sums, row_sums, grid_sums))

        # board_state = numpy.concatenate((column_sums, row_sums, grid_sums))

        # score_difference = (player_score - opponent_score) / (pip_count * turn)
        # game_progress = turn / length
        # match_state = numpy.array([score_difference, game_progress])

        # # Construct neural network input array
        # nn_inputs = numpy.concatenate((board_state, match_state))

        # Run neural network for current turn
        output = self.neural_network.propagate(nn_inputs)

        # Index on board as if a 1D array
        board_position = int(numpy.argmax(output))

        # Convert 1D index to grid, row, and column indexes
        grid = board_position % GRID_COUNT
        row = (board_position // GRID_COUNT) % ROW_LENGTH
        column = board_position // (ROW_LENGTH * COLUMN_LENGTH)

        return [grid, row, column]

    def getNN(self):
        return self.neural_network
