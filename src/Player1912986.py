import numpy


GRID_COUNT = 3
ROW_LENGTH = 3
COLUMN_LENGTH = 3

INPUT_SIZE = GRID_COUNT * 2 + ROW_LENGTH * 2 + COLUMN_LENGTH * 2
OUTPUT_SIZE = GRID_COUNT * ROW_LENGTH * COLUMN_LENGTH


def linear(a):
    return a


def relu(a):
    return numpy.maximum(0, a)


class Layer():
    def __init__(self, weights, biases, activation_function):
        if len(biases) != len(weights):
            raise ValueError

        self.weights = numpy.copy(weights)
        self.biases = numpy.copy(biases)
        self.activate = activation_function

    def forward(self, inputs):
        return self.activate(numpy.dot(self.weights, inputs) + self.biases)

    def getMatrix(self):
        return self.weights

    def getBiasVector(self):
        return self.biases

    def getFunction(self):
        return self.activate


class NeuralNetwork:
    def __init__(self, weights, biases, activation_functions):
        layer_count = len(weights)

        if (len(biases) != layer_count
                or len(activation_functions) != layer_count):
            raise ValueError

        self.layers = []

        for i in range(layer_count):
            layer = Layer(weights[i], biases[i], activation_functions[i])
            self.layers.append(layer)

    def propagate(self, nn_inputs):
        inputs = nn_inputs

        for layer in self.layers:
            inputs = layer.forward(inputs)

        return inputs

    def getLayers(self):
        return self.layers


class NNPlayer:
    @staticmethod
    def getSpecs():
        return (INPUT_SIZE, OUTPUT_SIZE)

    def __init__(self):
        weights = [
            [[-2.92932012e-01,-2.51303077e+00, 1.09367606e+00, 1.30276732e+00,
            -1.58626609e+00, 1.13961028e+00, 2.64527896e+00, 1.18352749e+00,
            -2.93431782e-01, 1.31900794e+00,-7.66312492e-01,-2.94504266e-01,
            6.30034994e-01,-1.51905877e-02,-2.79402957e-01, 2.33922303e+00,
            8.79566160e-01,-1.06112653e-01],
            [-1.75690513e+00, 1.32422904e+00,-2.22386698e-01,-4.96172039e-01,
            3.83606757e+00,-1.51287563e+00, 6.05259191e-01, 1.33814418e+00,
            1.54892428e+00, 3.13395562e-01, 8.75263198e-01, 2.03231322e+00,
            1.06129413e+00,-8.82443094e-01,-8.34925611e-01, 5.17855437e-01,
            2.22525376e-01, 4.51736487e-01],
            [-2.16930052e+00,-3.12593805e-01,-2.08421028e+00, 1.31846961e-01,
            4.75519741e-03,-1.09610404e+00, 2.59068511e+00,-3.03725346e+00,
            5.42564691e-01, 3.30305000e+00,-4.80892261e-01, 9.21941517e-01,
            -7.35083912e-01, 1.09029802e+00,-4.58404985e-01,-5.88029406e-01,
            -1.59146582e+00, 6.17641301e-01],
            [ 6.12000316e-01, 1.02204037e+00, 5.16183619e-01,-2.57064983e+00,
            -5.96778888e-01,-1.87808178e+00,-7.29677372e-01, 2.22910611e+00,
            2.07335791e-01,-2.97464937e-01,-2.23401901e+00, 1.44302042e+00,
            6.71678969e-01,-1.22738276e+00,-6.50698000e-01, 1.21274777e-01,
            5.41544381e-01,-9.60245866e-01],
            [ 2.50403337e+00,-3.71465073e-01, 1.13451728e+00, 1.17627130e+00,
            -1.46130907e+00,-8.63438729e-01, 1.75186141e+00,-8.12642054e-01,
            -3.33408810e-01, 9.39219357e-01, 1.25271323e+00, 1.31117641e+00,
            -1.02645866e+00,-7.48618610e-01, 5.50973924e-01,-5.97792722e-01,
            2.94792343e-01, 2.62249807e+00],
            [ 6.61661565e-01,-7.10617101e-01,-5.52493335e-01,-1.10671814e+00,
            -4.67855266e-01, 2.17281251e+00,-2.47634470e-02,-2.63983766e-01,
            4.76937241e-01, 5.09522370e-01, 2.31536606e-01,-1.57343516e+00,
            -2.52472257e-02,-5.12947021e-01,-2.37036587e-01,-1.72248568e-01,
            1.88971859e+00, 1.22993014e+00],
            [-8.84892119e-01,-1.30801004e+00, 2.55592767e-01, 4.86350513e-02,
            7.49688524e-02, 2.08058799e-01,-2.10892989e-01, 1.36965908e+00,
            1.14362192e-01, 1.47999627e+00,-1.24550320e+00, 1.01974724e+00,
            -2.02656580e+00, 6.03818758e-01,-2.88917337e-01, 1.17694928e-01,
            -9.34752249e-01, 7.14264816e-01],
            [ 1.62504235e+00,-4.25300447e-02,-1.50036242e+00,-1.29857309e+00,
            -1.09779754e-01, 9.05148571e-01, 1.47726240e-01, 2.50386068e+00,
            -2.60211774e-01, 2.55458016e+00, 6.88700523e-01,-9.47082483e-02,
            7.85437141e-01, 7.43527070e-01,-1.73741292e-01,-1.29892983e+00,
            1.27179697e+00, 1.35236033e+00],
            [ 1.34769586e+00, 7.81643381e-01, 4.64318149e-01, 4.36153766e-02,
            3.75953084e-01, 8.44049102e-01,-2.95463585e+00, 8.89284504e-01,
            -3.82946027e+00,-3.22106545e+00,-9.58967650e-01,-4.18474267e-01,
            7.65591787e-01,-1.53768544e+00, 1.80288920e-01,-1.41210098e+00,
            1.87207527e+00, 5.51637332e-01],
            [ 2.16445227e-02, 1.92066336e+00,-2.84445270e+00,-1.30304115e+00,
            1.49379495e+00, 7.22446621e-01,-3.14984286e-01, 2.03342202e+00,
            1.78661315e+00,-2.18661473e+00, 6.05675233e-01, 2.19258059e-01,
            -9.50782475e-01,-1.54100450e+00, 1.94625715e+00,-6.91068760e-01,
            -1.66328491e+00,-6.63259742e-01],
            [ 1.06734605e+00,-3.34692113e-02,-4.14196332e-01, 2.28966564e+00,
            -7.07238227e-02,-7.21684952e-01,-1.15138944e+00,-1.04303225e+00,
            1.19250820e+00, 1.23045541e+00, 6.34126817e-02,-1.26600136e+00,
            2.36638421e+00, 9.61923119e-01, 8.41577718e-01,-2.57930016e-01,
            -1.81715662e+00, 1.17014127e+00],
            [ 2.18868991e+00, 7.06419161e-01, 2.26526966e+00,-3.55688842e-01,
            -6.45046699e-01,-7.59491644e-02,-6.42412530e-01, 1.11799144e+00,
            -2.39724901e-01, 1.06995704e+00, 8.50553586e-01, 7.56771634e-01,
            8.87359886e-01, 2.24685181e+00,-1.63978038e+00,-2.43906831e+00,
            -3.19066972e-01,-1.57977385e-01],
            [-2.80278873e-01, 1.06892135e+00,-7.41712794e-01, 1.21410638e+00,
            2.82925492e+00, 2.83203108e-01,-3.65007601e-01, 4.67045478e-01,
            -7.11644052e-01,-6.46083781e-01, 1.67799575e-01, 1.42779440e-01,
            1.09153806e+00, 1.10098057e-01,-3.13047703e-01,-1.02173484e-01,
            -2.26076989e+00, 1.30510623e+00],
            [-4.62344782e-01, 1.06952393e-02,-1.31563961e+00,-2.05381187e+00,
            1.46173907e+00, 4.46528934e-01,-4.18979691e-01, 3.98425369e+00,
            -2.19345283e+00, 5.36942420e-01, 7.38737980e-01,-1.97363394e+00,
            -7.76384074e-01,-1.57520372e+00,-1.39268171e+00,-2.38041260e-01,
            -1.32734689e+00,-4.89803457e-02],
            [-1.68985546e+00,-2.23308996e+00, 1.03399924e-01,-1.37233880e+00,
            -1.34702779e-01, 1.19611649e-01, 8.78999043e-02,-5.06845147e-01,
            2.58254627e+00, 2.78869479e+00,-1.56911729e+00,-1.33419004e+00,
            2.43635105e-01,-3.39702853e-01, 2.97335699e+00, 1.45843285e+00,
            -7.75205120e-01,-2.41254982e-01],
            [ 4.49064915e-01,-1.93693451e+00,-1.25064357e+00, 9.09862373e-01,
            1.37371799e+00, 1.44632465e-01,-2.50126148e+00, 8.90163239e-02,
            1.85968144e+00, 6.02690219e-01,-3.48113640e-01, 1.97600695e+00,
            1.71352258e+00, 2.41249503e-01,-2.37595637e+00,-2.75163641e+00,
            -1.64443708e+00, 3.61102373e-01],
            [-1.64379685e+00,-2.17503706e+00,-3.66943887e-01, 1.56112713e+00,
            -1.47035920e+00, 1.94524594e-01,-1.62440992e+00, 5.93622364e-01,
            -7.26089381e-02, 2.85621004e-01, 3.66519283e-01, 2.19427610e+00,
            1.31449143e-01, 1.01810108e-01,-2.22778055e+00,-1.05799397e+00,
            -2.90628652e+00, 9.99563882e-01],
            [-1.45827509e+00,-8.38154877e-01, 9.14558505e-01, 1.54542397e+00,
            -1.17693880e+00,-1.84215453e+00,-2.14452381e-01,-2.04758073e-01,
            1.09624323e+00,-2.90982683e+00,-1.74467578e-01, 2.07490401e+00,
            2.77384473e+00, 8.03708028e-01, 6.50549663e-01, 1.62864935e+00,
            -2.35777527e-01,-6.55016738e-01],
            [ 2.41415054e+00,-1.82922946e-01, 6.27881004e-01, 5.69467847e-01,
            1.59513708e+00, 5.69524941e-01, 8.22961476e-01,-6.90712793e-01,
            -2.26475542e-02, 8.20128553e-01,-1.54033483e-01,-9.14014289e-01,
            5.02717653e-01, 8.60388382e-01, 1.30237349e-01,-8.00059262e-01,
            -1.89666508e-02, 3.36427378e+00],
            [ 2.11241755e+00, 1.25927174e+00,-1.22271542e+00,-2.26164004e+00,
            -6.03342490e-01,-4.11166169e-01, 5.81746449e-01,-7.40265299e-01,
            -8.14874458e-02, 9.88172446e-01, 1.79069043e+00,-7.93106588e-01,
            -1.45700861e+00,-1.05743307e+00, 1.27084356e+00, 1.07650731e+00,
            -2.12044915e+00, 8.43412275e-01],
            [ 5.32002190e-01, 2.82831553e+00, 6.39089470e-01, 4.47683059e-01,
            1.61686877e-01,-1.13600376e+00, 6.91114395e-01,-5.22188091e-01,
            3.87471330e-01,-8.39412019e-01, 4.10813799e+00, 5.20865337e-01,
            1.77182542e+00, 1.77799435e+00,-1.05701839e+00, 2.98181339e-03,
            -2.31180453e+00,-1.15363962e+00],
            [-1.27990157e+00,-1.33329662e-01, 1.08865917e+00,-3.05495905e-01,
            8.71987637e-01, 6.43875974e-01,-1.39644965e+00, 4.67327174e-02,
            1.46448613e-01, 6.56043556e-01,-6.48845835e-01,-7.48558782e-01,
            8.82427115e-01, 1.10368029e+00, 7.22961983e-01,-3.77706226e-01,
            1.75429737e-01,-1.54268800e-01]],
            [[ 1.46901116e+00, 5.11791793e-01,-7.61753901e-01, 7.69704050e-01,
            4.30520673e-01,-2.99988895e-01, 3.14482076e-01, 1.90776218e+00,
            6.96901488e-01, 1.22546675e+00,-1.02840856e+00, 1.29909520e+00,
            6.44633184e-01,-5.52794236e-02, 3.82838036e-01,-1.23983139e+00,
            9.83989783e-01, 2.13478610e+00, 2.04144949e+00,-2.61256622e+00,
            2.77410690e-01, 1.71096523e+00],
            [ 2.13794171e+00, 3.92603782e-01,-2.20257084e-01, 9.87383529e-01,
            -8.85730512e-01,-6.67425386e-01, 6.46950518e-02, 2.49252129e-01,
            1.03811997e-01,-1.85918280e+00,-3.73682238e-01, 1.20484588e+00,
            8.59459783e-01,-3.29511748e-01, 2.03970291e-01,-6.83431044e-01,
            -2.07595851e+00, 8.82243013e-01, 7.73795219e-01,-5.80200474e-01,
            -2.16618847e+00, 1.37315818e+00],
            [ 1.82814962e-01, 1.37033754e+00,-1.84611775e+00, 1.39718355e+00,
            1.26510356e+00, 1.47528402e+00,-1.58158342e-02, 2.31795853e-01,
            -6.60436334e-01, 9.85425557e-01,-1.59694197e+00,-9.67480416e-01,
            -2.88000804e-01,-2.56849552e+00, 1.71490084e+00, 1.81670871e+00,
            1.82852206e+00,-1.41546599e+00,-7.84276673e-01, 2.44041153e+00,
            -7.33305725e-01, 3.38833777e-02],
            [ 2.49901209e+00,-2.43512127e+00,-6.41398571e-01,-1.15136044e+00,
            1.06152162e+00, 2.54759040e+00, 1.16669297e+00,-2.11815482e+00,
            1.86777895e+00, 9.97284353e-01, 1.34163784e+00,-9.41673816e-02,
            -2.09435385e-01, 3.55170846e-01,-1.67449978e+00,-1.45472103e-01,
            -1.61011708e+00,-1.14210967e+00,-9.47944094e-01,-1.46688681e+00,
            1.43489632e+00, 9.97507807e-01],
            [ 5.77892198e-01,-9.86555315e-01, 2.05816332e+00,-1.89140048e+00,
            4.57629429e-01, 3.70403444e-01, 2.79744189e-01,-2.66806109e-01,
            1.86263199e+00, 3.96559288e-03, 2.13435026e+00,-2.95099910e-01,
            -5.82447573e-01, 1.33783985e+00, 3.32096844e-01,-5.41511598e-01,
            -5.08584595e-01, 3.38412570e-01,-8.79989965e-01, 2.76378738e-01,
            -3.52603306e+00, 1.44895962e-01],
            [ 3.95830796e-01,-1.16625586e+00,-7.92884919e-01,-1.16876853e+00,
            -6.69406421e-01,-2.56190199e+00,-1.19743869e+00, 1.12005167e+00,
            -7.39747691e-01, 2.11759931e+00,-1.07642504e+00,-6.08282632e-01,
            8.44539610e-01, 2.07912860e+00,-1.96715726e+00, 1.54267104e+00,
            -4.56961228e-01, 1.60093040e+00,-3.53957828e+00,-1.29380673e+00,
            1.02558953e+00, 4.96878540e-01],
            [ 2.08244940e+00, 5.27190767e-01,-1.50594520e+00, 4.21687898e-01,
            1.65432908e+00, 8.87536102e-01, 3.52220972e-01, 2.19586379e+00,
            2.51241766e+00,-1.14536664e+00, 2.57015597e-01, 2.76666164e+00,
            1.12586598e-01,-3.14767647e-01,-2.58600677e+00,-6.01851856e-01,
            -4.01395557e-01, 1.01283361e+00, 2.01270066e+00,-1.35437999e-01,
            -2.27487589e-01, 4.89763817e-01],
            [-5.61233983e-01, 2.64978379e-01,-2.38670433e-01,-4.80648409e-01,
            7.83362304e-01, 1.21671986e-01, 1.53025271e+00, 6.72309151e-01,
            -8.79980223e-01,-1.25911961e+00,-1.02729861e+00, 5.35936776e-01,
            -1.57749469e+00,-1.85650819e-01,-7.16377140e-01,-6.17506922e-01,
            -1.76282883e-01, 2.30473078e+00,-2.10731242e+00,-1.75496802e+00,
            1.04496499e+00, 1.21615222e+00],
            [ 1.73615869e+00, 2.65180020e+00,-2.49309836e-01,-1.61328277e+00,
            -2.28323133e+00, 1.14051893e+00,-2.42636727e-01, 4.70249467e-01,
            -2.71656268e+00,-2.99951911e-01, 4.82786459e-01,-4.13705230e-02,
            2.69983310e+00, 7.27017689e-01, 1.91618383e+00, 4.39641305e-01,
            8.61598508e-01, 7.67774419e-01, 2.17811359e+00, 1.26138527e+00,
            -1.35301621e+00, 5.10474567e-01],
            [ 2.63895846e-01,-6.96608454e-01,-6.61615235e-01,-2.11698478e+00,
            -1.52317689e+00, 2.14104957e+00, 2.22610073e+00, 5.06927910e-01,
            1.37042983e+00, 2.48954495e+00,-2.14904277e+00,-5.89414015e-01,
            -1.43055965e+00,-2.00309927e-01,-2.58971701e-03, 2.67645427e+00,
            1.24162264e-01,-5.58540041e-01,-1.89945825e+00, 6.86921194e-01,
            -1.18810554e+00,-1.71521452e+00],
            [-1.83344721e+00,-1.11604868e+00, 2.20109880e-01,-1.15390807e+00,
            -1.50492161e+00,-1.55985267e+00, 2.88224759e+00,-2.01961723e+00,
            1.54359770e+00,-2.33977160e+00, 2.86858247e+00, 1.18936404e+00,
            -2.47913166e+00, 1.13691730e+00,-9.91199933e-01, 1.67290696e+00,
            -1.58206656e+00,-7.08537215e-01,-5.10903926e-01, 8.05597506e-01,
            -1.23552444e-01,-2.17693715e+00],
            [ 1.28299293e+00,-2.90432932e-01, 5.62928091e-01,-1.06574242e+00,
            3.48345807e-02, 2.76883654e+00,-1.54003042e+00,-4.48501892e-02,
            1.53828387e+00,-4.83260125e-01,-1.58100138e+00, 2.52717699e+00,
            -1.01731646e+00,-1.66866967e+00, 7.84543391e-02, 9.98901845e-01,
            -2.00256190e-01, 2.85901573e+00, 1.37169606e+00,-5.72601050e-01,
            5.84299618e-01,-1.87609961e+00],
            [-1.79429103e+00, 1.20296486e+00, 2.31535117e+00,-7.39491947e-02,
            4.47101969e-02, 3.97409085e-01,-4.56377145e-01, 4.40351128e-01,
            -1.03406407e+00,-2.51337383e+00, 1.53232172e+00,-1.18077857e+00,
            1.09715053e+00, 3.50752532e-01, 4.81700454e-01,-1.14176252e-01,
            2.35004347e+00,-1.11191725e+00,-2.34424092e-01,-6.77794174e-01,
            3.08916922e-01, 1.44417602e+00],
            [ 1.63461026e+00,-4.33665968e-01,-2.26931516e+00, 1.27851226e+00,
            -1.59847900e+00,-1.90510205e+00, 3.42210822e-01, 1.79951824e-01,
            2.63630427e-01, 1.07296078e+00, 8.04247794e-01, 4.31537705e-02,
            6.89804461e-01,-2.06319151e-01, 1.83885889e-02,-1.38621404e+00,
            9.04471166e-01, 3.63813471e-01,-4.49572716e-01,-1.90771035e+00,
            2.93085599e+00,-1.27581866e+00],
            [-7.11386172e-01,-1.17669508e+00,-9.38323677e-01, 1.83034504e+00,
            -1.65920694e+00,-2.73877916e-01,-1.61106829e+00, 1.45751335e+00,
            -6.40523061e-01, 1.02663992e+00,-1.96778788e+00,-7.41149401e-01,
            -8.22818742e-01,-3.71024659e-01, 1.84874010e+00,-5.52760405e-01,
            1.56045477e+00,-5.65991951e-01,-1.41406446e+00, 2.37717101e+00,
            -5.01369616e-01, 2.86593350e-01],
            [ 7.50313942e-01,-1.25260283e-01,-5.54641074e-01, 1.56809137e+00,
            1.14559753e+00,-2.23816717e+00, 7.52757379e-01, 5.81219160e-01,
            2.46721870e-01,-1.21326546e+00,-2.03639200e+00,-2.77512867e-01,
            1.87378679e+00,-6.72762799e-01,-3.64019148e-01,-9.82106790e-01,
            -1.65993167e+00,-2.29664552e-02,-8.72044367e-01, 3.37979375e+00,
            1.29518275e+00,-1.78083079e+00],
            [ 5.24356955e-01,-3.61305244e-01,-1.03701229e+00,-3.08401959e+00,
            7.74281130e-01,-1.59616901e+00, 1.21305340e+00,-1.32371051e-01,
            4.84294157e-01,-5.56386211e-01,-2.70449317e-01, 2.49790276e-01,
            -2.91960738e+00,-1.80400724e+00,-1.25075255e+00,-2.13279946e+00,
            -6.30193105e-01,-4.30825522e-01, 3.01565384e-01,-3.14570945e+00,
            -5.47325219e-01, 7.52535285e-01],
            [ 7.80275151e-01, 4.81867633e-01, 1.47947345e+00,-1.42908300e-01,
            -2.03648844e+00, 3.70634095e-01,-2.01125593e+00,-1.60510381e+00,
            -2.00043557e-01, 5.96861313e-01, 3.15389417e-01,-1.80807113e-01,
            -4.18815008e-01, 5.89784122e-01, 1.30428141e+00,-1.29025813e+00,
            -1.96104519e+00,-1.17843506e+00, 2.29934046e+00,-1.91010743e+00,
            -7.62428856e-01, 2.79309780e+00],
            [-7.26830332e-01, 6.79109974e-01,-5.93703637e-01, 7.57176828e-01,
            -3.13151264e+00, 2.31434931e-01, 1.50630142e+00,-2.56496471e+00,
            7.76672782e-01,-4.05321301e-01,-1.42334756e+00,-4.67943245e-01,
            -2.77294854e+00, 1.31305222e+00,-2.42134186e-01,-1.31925451e+00,
            -2.37176623e-01, 1.27459952e+00, 3.76453410e-01,-8.55102270e-01,
            -1.81839380e+00, 2.49344501e+00],
            [ 1.96752080e+00,-2.35586600e+00, 2.19021516e+00, 1.91192496e+00,
            -7.68389782e-01, 5.86589610e-01, 9.07167362e-01, 4.53782828e-01,
            1.93207137e-01, 3.04757343e-01, 1.19260828e+00,-5.83186514e-01,
            3.12381266e-01,-1.25335962e+00,-7.60554421e-01, 1.14615170e+00,
            9.92682255e-01, 8.05248234e-01, 1.38371153e+00, 3.43878651e-01,
            -4.48271727e-01,-1.76225772e+00],
            [ 2.88516258e-01,-1.36830217e+00, 5.34069615e-01, 1.77949431e+00,
            -4.41291111e-01,-6.39506838e-01,-2.09534798e+00, 4.77463517e-01,
            1.98435566e+00,-1.99889628e+00, 8.53637441e-01, 6.62941834e-01,
            7.04602427e-01, 7.62372853e-01, 2.07295945e+00, 2.19023534e+00,
            -1.57324922e-02, 1.87148067e+00, 3.56558686e-01,-1.10909456e+00,
            1.01924305e+00, 1.92883507e+00],
            [-2.16505215e+00,-1.88178601e+00, 2.45183158e-01, 6.51162070e-03,
            -6.52907142e-01,-8.40573375e-01, 1.22409429e+00,-1.96690073e+00,
            -1.58520936e+00, 1.63211129e+00, 2.18325845e+00, 2.11545461e+00,
            2.69686545e-01, 1.94049259e-01,-2.09137806e+00,-6.96364154e-01,
            -3.02087493e+00,-1.32405075e+00,-1.02759730e+00, 1.94110474e-01,
            1.44713429e-01, 3.43491597e-01],
            [ 4.28656593e-01,-3.42467665e+00, 1.26467112e+00, 8.05361248e-01,
            9.60922627e-02, 1.77961903e-01,-6.89069139e-01,-3.84423338e-01,
            -1.64320978e+00, 1.44219661e+00,-2.94683690e-01, 3.78137300e-01,
            -8.69854719e-01, 2.54949331e-01, 9.42017927e-01,-2.36192228e+00,
            -2.10999953e+00, 1.65797519e+00,-1.83284781e+00, 2.85924249e+00,
            2.34698435e+00,-2.73234262e+00],
            [-5.67461112e-01, 1.15081472e-01,-4.86953118e-02, 1.30530484e+00,
            1.32209172e+00,-2.08231306e+00, 2.24376417e+00,-1.22618404e+00,
            -5.46600687e-01,-1.20310056e+00, 3.68161261e-01,-9.66825012e-01,
            -1.36464144e+00, 1.28344677e+00,-1.17915366e+00, 2.73283696e-01,
            -8.88416151e-01, 2.04119650e+00, 1.63772407e+00,-3.49810355e-01,
            2.04319892e+00, 9.47381718e-02]],
            [[-9.04225207e-01, 9.53424544e-01,-2.36499191e+00,-2.16401437e-01,
            1.14467000e+00, 1.22787053e+00, 2.49149260e+00, 7.82611969e-01,
            3.72802305e-01,-2.30297133e+00, 4.30101640e-01,-1.11709862e+00,
            9.64197354e-01,-9.01112584e-02,-1.60458165e+00,-5.66157750e-01,
            9.74685934e-01,-1.37633215e+00,-2.41715298e+00, 2.11048789e-01,
            -1.41576568e+00,-3.02041711e+00, 1.28701042e+00,-5.99326482e-01],
            [-1.08759424e+00,-3.17250567e+00, 2.65225650e+00, 1.22892037e-01,
            -1.20938360e-01, 7.24407823e-01,-1.46799228e+00,-1.38642236e+00,
            6.89015660e-01,-1.17487029e+00, 3.76325541e-01,-1.12703753e-01,
            2.91914018e-01, 3.39510779e-01,-1.38225898e+00,-3.68680479e-01,
            5.20604123e-01,-2.97392056e+00, 3.68099527e-01, 3.34218821e-01,
            -1.87572150e+00, 3.36587937e-01, 6.24273127e-01, 1.94338958e+00],
            [-1.54623480e+00, 2.60643921e-01, 1.07066538e+00,-6.23530175e-01,
            -1.20739357e+00,-1.52959435e+00, 3.14951514e-01, 3.05127208e-01,
            -1.09474481e+00,-1.43359578e+00,-2.20111020e+00,-1.45582902e+00,
            9.35100445e-01,-9.08979066e-01, 1.70722332e-02, 1.88365043e+00,
            -7.37835738e-02,-2.17685565e+00, 1.36869957e+00, 1.04696159e-01,
            9.12052054e-01,-5.87232559e-01, 5.75356011e-01, 8.94115718e-01],
            [-5.12374672e-01,-1.83474502e+00,-2.45311916e-01, 5.68918098e-01,
            -1.29929418e+00, 1.84195383e+00,-7.58945676e-01,-1.41307384e+00,
            1.43873964e+00, 7.01144236e-01,-1.15503862e+00,-3.61854394e-01,
            -3.05262509e+00, 3.02210484e+00, 1.02951624e-01,-2.98517473e+00,
            -2.26200263e+00, 2.34378492e+00,-2.47151776e-01,-3.07483743e+00,
            3.38020144e-01, 4.59518551e-01,-2.17980422e+00,-1.11237680e+00],
            [-1.37433845e+00,-2.17462721e-01, 2.04307876e-01, 1.08032551e-01,
            -9.44034397e-01, 2.75320880e-01,-7.76152437e-02,-1.54861501e+00,
            -3.99298968e-01,-1.79149490e-01,-2.31820758e+00,-2.62490259e-01,
            8.94778682e-01, 2.79112460e+00,-1.12003100e-01,-7.65229141e-01,
            1.16488686e+00, 1.12303023e+00, 2.12367504e+00,-1.88320705e+00,
            -1.05837096e+00,-2.55078174e+00, 8.09818108e-01,-1.34880151e-02],
            [ 1.45832801e+00, 1.58361291e+00,-1.36808686e+00, 1.57600142e+00,
            -6.40224552e-01,-8.40004095e-01,-9.00764983e-01, 5.81979296e-01,
            -1.08163775e+00, 3.00313251e-01, 1.22364392e+00, 2.77498950e-01,
            1.90576728e-02, 2.66638017e-01, 2.80758284e-01, 3.45488193e-01,
            7.51165069e-01,-9.77711404e-01,-1.00055968e+00, 4.26800773e-01,
            5.02262912e-01,-4.30291475e-01,-1.32297999e+00, 5.64947383e-02],
            [ 1.08295211e+00,-4.11256343e-01,-1.12352321e+00,-1.66889388e-01,
            1.02618231e+00,-1.88469295e+00,-1.52347443e+00,-9.51454393e-01,
            -1.06706584e+00, 1.71391208e+00, 2.44529611e-01,-8.17549593e-01,
            4.16497278e-01, 7.36734972e-01,-8.67401096e-01,-1.05814570e+00,
            1.72286572e+00,-8.95800576e-02, 1.67038253e+00,-4.09002636e-01,
            -4.84746940e-01, 1.77284685e+00, 7.69971958e-01,-9.50490359e-02],
            [ 6.08626212e-01, 1.04096554e+00, 1.42164907e+00,-3.74893785e-01,
            4.30628438e-01, 1.89870498e+00,-6.89483571e-02,-7.65869646e-01,
            1.67189718e+00,-3.97551581e-01, 3.20936190e+00, 9.07971165e-01,
            2.70682639e+00, 5.97791946e-01,-4.87886196e-01,-1.90575444e+00,
            -1.28328478e+00, 1.84981613e+00, 1.27676184e+00,-9.06808602e-01,
            1.11453823e+00, 4.68520338e-01,-8.23078988e-01, 1.07449228e-01],
            [-3.64672397e-01, 1.29169099e-01,-9.79093757e-02,-4.70548811e-01,
            7.67763162e-01,-3.48532334e-02, 1.86445747e+00, 4.97453699e-01,
            9.96812490e-01,-1.12255092e+00, 1.63619420e+00,-1.74323382e-01,
            3.41943763e-02, 2.73835283e-01, 6.69170436e-01, 1.07369079e+00,
            3.59481320e-01, 4.11033996e-01,-7.42537861e-01,-1.97585875e+00,
            -2.24991540e+00, 5.64820997e-02, 8.32720191e-02,-9.69349556e-01],
            [-2.57052709e+00, 4.23182809e+00,-1.37258717e-01,-8.34379992e-01,
            -1.43875771e+00,-9.63870791e-01, 1.11780192e+00, 4.38173731e-01,
            8.64906993e-01, 2.24649997e+00,-5.59336722e-01, 4.76329601e-01,
            2.15968049e+00, 2.10212419e+00, 1.91351536e+00,-8.49250782e-01,
            -1.82564344e+00,-6.48559035e-01,-1.46607837e+00, 4.60764225e-01,
            -5.40734717e-01, 5.88648415e-02,-1.12578880e+00, 3.85877198e-01],
            [ 9.85959539e-01,-5.68158423e-01, 9.72004732e-02, 1.90809460e+00,
            -2.24607104e-01,-1.54445365e+00,-2.55338990e+00, 4.61996712e-01,
            -7.92983138e-01,-1.13425845e+00,-9.60403293e-01,-2.80864096e-01,
            3.53283858e-01, 2.57226531e+00,-7.56911676e-01,-4.94287544e-01,
            2.67702404e+00,-3.85643509e-01,-1.58094214e+00,-3.27824615e-01,
            -4.57883395e-01, 2.15111332e+00, 3.08919985e+00,-7.46590517e-01],
            [-1.08209763e+00,-8.39000268e-01, 6.71629306e-01,-3.05081625e+00,
            -1.00795775e+00,-2.55464822e+00,-1.07386463e+00, 8.58402931e-02,
            -5.99940047e-01, 2.45254072e+00,-7.50493702e-01, 1.52564374e-01,
            -4.43075020e-01, 1.07216762e+00,-1.92034798e+00, 1.46911937e+00,
            -2.43066515e+00,-1.23796431e+00,-1.00897864e+00, 7.00477087e-01,
            -1.06531614e+00, 3.85589503e-01, 3.79875941e-01,-5.27959018e-01],
            [-1.35734096e-02, 1.21384691e+00, 8.00572114e-02, 4.17832720e-01,
            9.72600271e-03,-1.67125311e+00,-1.23720745e+00, 4.32163675e-01,
            -1.80275690e+00, 1.13309911e+00, 8.60556627e-01, 6.14045408e-02,
            5.17092978e-01,-2.00780821e-02, 6.72492072e-01, 5.43712052e-01,
            -1.53880405e+00, 1.59866374e+00, 2.01357686e+00, 7.93520847e-01,
            -8.39484351e-01,-8.16085451e-01, 2.31007361e-01, 1.15128427e-02],
            [-1.65959432e+00, 8.70603423e-02, 1.63998047e+00,-7.61609645e-01,
            4.12814733e-01, 4.28892588e-01, 1.00886672e+00,-1.95344061e+00,
            -1.56640387e+00,-3.21859979e-01, 2.19027535e+00,-1.50663051e+00,
            3.31003322e-01,-1.80446899e-01,-1.56974758e+00, 1.32995170e+00,
            -1.64652600e+00,-1.22784375e+00,-1.39404797e+00, 5.42993560e-01,
            -1.72548298e+00, 1.86250716e+00, 5.72541746e-01, 1.68202503e+00],
            [-9.04750459e-01, 3.17916322e-01, 1.78463557e+00, 9.93055372e-01,
            1.37432133e+00, 1.17165795e+00,-1.09323363e-01,-1.27253284e+00,
            2.39467156e+00,-1.31825447e+00,-4.48515975e-01,-9.82466778e-01,
            -3.24323698e+00,-6.85871840e-01, 3.16546186e-01, 2.29144156e-01,
            -1.38435195e+00,-1.40530325e+00, 2.55162823e-01,-1.65884730e+00,
            -1.28261021e+00,-8.94760714e-01, 1.44354705e-02, 1.23474821e+00],
            [ 1.34925146e+00,-8.28368501e-01, 4.13585702e+00,-1.08243002e+00,
            9.50952654e-01, 1.36905353e+00,-4.18506666e-01,-2.62502961e+00,
            1.04049069e+00, 2.21425491e-01,-1.53285105e+00, 2.62218146e-01,
            -2.41425159e+00, 6.26554024e-01,-5.60964923e-02, 5.72483443e-02,
            -1.10545974e+00, 5.69219500e-01, 3.42025785e-01, 2.99113761e+00,
            -1.44176882e+00,-9.16785024e-01,-9.04398577e-01,-1.04709286e+00],
            [ 4.95557501e-02, 3.97413685e-01, 8.93134680e-01, 8.50385612e-03,
            3.87292127e-01, 1.23626484e+00,-2.50810486e-01,-2.15808887e+00,
            -7.08617570e-03,-1.61066163e+00,-1.27788454e+00,-1.81510978e+00,
            -3.89253175e-01,-5.50968215e-01, 5.47413064e-01,-4.29430569e+00,
            9.28069982e-01,-1.88284271e+00, 2.33997259e+00,-5.43199859e-01,
            -2.08686329e+00, 5.36623363e-01,-1.17092387e+00,-2.31888003e+00],
            [-3.14778340e-01,-5.85155574e-01,-1.20297141e-01,-6.09293496e-01,
            -1.10920987e+00,-2.52563247e-01,-2.10486372e+00,-2.24564700e-01,
            1.44805182e+00,-2.25990854e+00,-2.38245499e+00, 2.62165430e+00,
            8.91807136e-01, 1.55594287e+00,-8.88606310e-01,-1.33402784e+00,
            -1.76536828e+00,-4.36378290e-01,-9.86359264e-01,-5.47632944e-01,
            1.35625692e-01,-1.29973229e+00,-3.18396829e-01,-1.76529527e+00],
            [-3.15402417e-01, 1.11323183e-01, 6.88945002e-01,-3.09924292e-01,
            -1.59036006e+00,-1.32121467e+00,-7.68435572e-01, 2.76309092e-02,
            -1.65613462e+00,-6.40879975e-01, 2.28887209e-01, 9.27928456e-01,
            -3.44509047e-01,-4.47615785e-02, 5.48291305e-01, 9.99210443e-02,
            -1.24402165e+00, 1.20939484e-01,-4.55805768e-01, 1.27008918e-01,
            -6.67026905e-01, 1.63517889e+00,-1.90389828e+00,-1.16151265e+00],
            [ 1.76532664e+00, 2.89114109e-01,-1.68804442e+00,-8.08248462e-01,
            2.52841792e-01, 1.79395079e+00,-6.95674269e-01, 4.55986137e-01,
            2.14428153e+00,-9.61060443e-01, 2.55706611e-01,-2.89609062e+00,
            1.26851590e-01,-2.91464789e+00,-5.19370421e-01,-6.85564697e-01,
            8.36275180e-01,-4.57420114e-01, 3.32964730e-02, 1.62109694e+00,
            -1.42658497e+00, 2.63440809e+00,-4.94306509e-01,-1.76535081e-01],
            [ 7.11590620e-01, 1.17029849e+00, 2.49913071e-01,-5.87881321e-01,
            3.72846985e-01,-1.67753068e+00,-6.17138737e-01, 7.38732665e-01,
            -2.81019169e-01, 1.33969182e+00,-5.55680256e-01,-5.04633788e-01,
            3.49384016e-01, 5.11324733e-01, 7.81617285e-01, 7.63813258e-01,
            4.29560739e-01,-1.10462834e+00, 4.93092669e-02,-1.93566526e+00,
            -2.91429188e+00, 1.11321628e+00, 1.25587198e+00, 5.50259996e-03],
            [ 5.79161473e-01, 2.37248455e-01, 9.73649742e-01, 8.02710986e-01,
            -7.28885392e-01, 2.67144636e+00, 5.77974730e-01,-3.88565077e-02,
            1.39788772e-01,-1.43087691e+00,-1.90457082e-01,-8.51149771e-01,
            -1.92596807e+00,-1.78533729e+00,-3.11651368e+00,-1.60294076e-01,
            -3.80035486e-03,-1.19246017e+00,-6.61109927e-01,-7.49676774e-01,
            5.61832114e-01,-1.06498627e+00,-1.45885013e+00,-9.27479101e-01],
            [-6.14209451e-01, 1.40813809e+00, 1.81931000e+00, 1.20256097e+00,
            -1.27861133e+00,-2.42212622e+00, 3.70857864e+00, 1.72952315e+00,
            -2.86706145e-01,-1.25403616e+00,-1.55496158e-01, 6.35080701e-01,
            -1.49072083e+00, 1.27519819e+00, 1.42507413e-01, 8.19969881e-01,
            2.36057558e+00,-9.71559357e-01,-9.39799525e-01, 4.49578099e-01,
            -4.68058896e-02, 2.17938302e+00,-1.71477090e+00, 1.71931458e+00],
            [ 1.30217715e-01,-1.02787279e+00, 1.24177292e+00,-1.22859829e+00,
            5.04244382e-01, 1.40623437e-01,-8.86474352e-01, 8.28613213e-01,
            1.66099479e-01,-1.15541886e+00, 8.99640372e-01, 7.44860901e-01,
            -1.82531960e+00, 1.10932567e+00,-1.28554553e+00, 5.71509516e-01,
            -2.09404560e+00,-6.71686809e-01, 1.34838421e-01,-1.31433727e+00,
            -2.40833500e-01,-3.57042392e-01, 2.67674318e+00, 1.74997290e+00],
            [ 1.18027356e-01,-1.74654581e+00,-7.84355364e-01, 3.40305579e-01,
            -2.00704145e+00, 6.91810568e-01,-4.84816218e-01, 3.32895834e-01,
            -1.62671541e+00, 9.43178846e-01, 5.61755438e-02,-1.09601738e-01,
            -1.13590778e+00,-1.99814412e-01,-1.92396723e-01,-1.00521506e+00,
            1.08832197e+00,-7.75499356e-01, 5.13161614e-01, 8.25336123e-01,
            7.81041424e-01,-6.98492311e-01,-1.34370447e-01,-8.93268601e-01],
            [ 7.97024704e-01, 2.72545397e+00,-3.15433627e+00,-4.17125424e-01,
            5.03518033e-01, 1.32358617e-02, 9.43410330e-01, 1.34560706e+00,
            8.22620489e-01,-2.05343182e+00,-8.68716352e-01,-1.30869470e-01,
            -2.58245131e-01,-1.02937338e+00,-1.98101144e+00,-2.33083650e+00,
            1.75333872e+00, 1.25280107e+00,-1.76015808e+00, 1.36224961e+00,
            1.27947960e+00,-2.61405566e-01,-3.68644888e-01,-1.15600446e+00],
            [-9.11305389e-01,-2.06214155e-01,-7.28767748e-01, 1.31615669e+00,
            1.57586103e+00,-7.15690927e-01,-1.61973831e+00,-2.11883254e+00,
            2.04210854e-01,-7.57095872e-01, 2.93359752e-01, 2.86191831e+00,
            -1.50476625e+00,-6.30745647e-01, 2.49669319e+00,-2.53849578e+00,
            3.24854174e-01,-1.67697220e+00,-1.16810585e+00,-1.02357265e+00,
            -1.76337433e+00,-3.23680032e+00, 1.23596527e-01,-1.49153860e-01]]
        ]

        biases = [
            [-0.14519503, 0.13209541, 0.43617279, 1.09798364,-0.88233365, 1.0989926 ,
            0.65295154,-0.11903752, 0.43013508, 0.75204337, 0.26481083,-0.92824833,
            0.40057087, 0.35318911, 0.69162066, 0.4451234 , 0.93403997, 0.03067761,
            0.51157608, 0.40531487,-0.0133497 , 0.77601036],
            [-0.4032597 , 0.09097297, 0.06175754, 0.43769841, 0.02028217,-1.98192594,
            1.08136242, 0.52447324,-0.49082265,-0.59481723, 0.62295803,-0.24144949,
            1.08679126,-0.62536982, 0.8812646 ,-0.53798179,-0.0632097 ,-0.47445048,
            -0.11728629, 0.63928116,-0.54007223,-1.14095935, 0.3287895 ,-0.44707937],
            [ 1.01607995, 2.00704022, 0.99521047, 1.28749575,-0.9304069 , 0.52936718,
            0.22839453, 0.31640963,-0.4922658 ,-1.3489826 , 0.15449365, 1.58078829,
            -0.028142  ,-0.06655293, 0.24251724, 0.32749506, 0.29143244, 0.84457968,
            1.23202243, 0.0619446 ,-0.2317582 ,-0.01048487,-1.82603259,-0.84167506,
            -0.21271599,-1.46013263, 0.45687958]
        ]

        activation_functions = [relu, relu, linear]

        self.neural_network = NeuralNetwork(
            weights,
            biases,
            activation_functions
        )

    def play(self, player_state, opponent_state,
             player_score, opponent_score,
             turn, length, pip_count):
        player_state = numpy.array(player_state)
        opponent_state = numpy.array(opponent_state)

        # Sum each column, row, and grid
        column_sums = numpy.ravel(
            [player_state.sum((0, 1)), -(opponent_state.sum((0, 1)))], "F"
        )
        row_sums = numpy.ravel(
            [player_state.sum((0, 2)), -(opponent_state.sum((0, 2)))], "F"
        )
        grid_sums = numpy.ravel(
            [player_state.sum((1, 2)), -(opponent_state.sum((1, 2)))], "F"
        )

        nn_inputs = numpy.concatenate((column_sums, row_sums, grid_sums))

        # Run neural network for current turn
        output = self.neural_network.propagate(nn_inputs)

        # Index on board as if a 1D array
        board_position = int(numpy.argmax(output))

        # Convert 1D index to grid, row, and column indexes
        grid = board_position % GRID_COUNT
        row = (board_position // GRID_COUNT) % ROW_LENGTH
        column = board_position // (ROW_LENGTH * COLUMN_LENGTH)

        return [grid, row, column]

    def getNN(self):
        return self.neural_network
