import numpy


GRID_COUNT = 3
ROW_LENGTH = 3
COLUMN_LENGTH = 3

INPUT_SIZE = GRID_COUNT * 2 + ROW_LENGTH * 2 + COLUMN_LENGTH * 2
OUTPUT_SIZE = GRID_COUNT * ROW_LENGTH * COLUMN_LENGTH


def linear(a):
    return a


def relu(a):
    return numpy.maximum(0, a)


class Layer():
    def __init__(self, weights, biases, activation_function):
        if len(biases) != len(weights):
            raise ValueError

        self.weights = numpy.copy(weights)
        self.biases = numpy.copy(biases)
        self.activate = activation_function

    def forward(self, inputs):
        return self.activate(numpy.dot(self.weights, inputs) + self.biases)

    def getMatrix(self):
        return self.weights

    def getBiasVector(self):
        return self.biases

    def getFunction(self):
        return self.activate


class NeuralNetwork:
    def __init__(self, weights, biases, activation_functions):
        layer_count = len(weights)

        if (len(biases) != layer_count
                or len(activation_functions) != layer_count):
            raise ValueError

        self.layers = []

        for i in range(layer_count):
            layer = Layer(weights[i], biases[i], activation_functions[i])
            self.layers.append(layer)

    def propagate(self, nn_inputs):
        inputs = nn_inputs

        for layer in self.layers:
            inputs = layer.forward(inputs)

        return inputs

    def getLayers(self):
        return self.layers


class NNPlayer:
    @staticmethod
    def getSpecs():
        return (INPUT_SIZE, OUTPUT_SIZE)

    def __init__(self):
        weights = [
            [
                [
                    -1.02159845e00,
                    -3.46362547e00,
                    9.66371025e-01,
                    3.37904585e00,
                    -7.76624607e-01,
                    -7.87938804e-02,
                    2.97290233e00,
                    9.36240197e-01,
                    -8.72109394e-03,
                    2.23708142e00,
                    -2.59498114e00,
                    -5.94056668e-01,
                    -5.15876479e-01,
                    -1.39960512e-01,
                    -2.05320659e00,
                    5.46575655e-01,
                    2.24320775e00,
                    -6.48231051e-01,
                ],
                [
                    -1.49570300e00,
                    1.53385783e00,
                    -5.23093572e-01,
                    -1.09424931e00,
                    4.17755623e00,
                    -2.25001802e00,
                    1.21939003e00,
                    9.16473638e-01,
                    2.53426634e00,
                    5.34104545e-01,
                    9.27736413e-01,
                    3.55580109e00,
                    1.53201030e00,
                    -1.95266342e00,
                    -2.10404575e00,
                    -3.03848358e-02,
                    1.62626313e00,
                    3.40216091e00,
                ],
                [
                    -2.72618649e-01,
                    -2.44615770e00,
                    -2.95618890e00,
                    6.53395919e-01,
                    1.52130615e00,
                    -1.85683631e00,
                    1.06647886e00,
                    -1.76999182e00,
                    -1.31162623e00,
                    4.35539741e00,
                    -2.28452441e00,
                    7.82769936e-01,
                    -1.29917502e00,
                    8.74237083e-01,
                    -7.54787749e-01,
                    -2.61301813e00,
                    -1.66516732e00,
                    1.83138801e00,
                ],
                [
                    2.03207755e00,
                    -1.79781264e00,
                    -6.16437923e-01,
                    -1.06442406e00,
                    2.49014957e-01,
                    -1.40070369e00,
                    -1.60396422e-01,
                    5.21195369e00,
                    -5.71597746e-01,
                    1.13449248e00,
                    -1.49501560e00,
                    1.11346233e00,
                    7.49669862e-01,
                    -6.47146655e-01,
                    -2.28759382e00,
                    2.56076169e00,
                    8.23001113e-01,
                    -1.46335606e00,
                ],
                [
                    3.67305155e00,
                    8.50257539e-01,
                    1.93357188e00,
                    2.06216256e00,
                    5.70675787e-01,
                    -8.62364251e-01,
                    1.71072500e00,
                    -1.88455224e-01,
                    2.17716927e00,
                    3.78374445e-01,
                    -1.64681643e-01,
                    8.20886038e-01,
                    -1.90076903e00,
                    -2.03421999e00,
                    -9.60517618e-01,
                    1.06379349e00,
                    9.02733875e-02,
                    2.65195873e00,
                ],
                [
                    -5.83055984e-01,
                    5.93926812e-01,
                    -3.61579991e-01,
                    -1.67073470e00,
                    1.16391581e00,
                    2.69391195e00,
                    -9.09868129e-02,
                    -2.59639558e00,
                    1.62695756e00,
                    2.36289087e00,
                    5.74601591e-01,
                    -2.76611341e00,
                    -1.02655357e00,
                    -1.97213860e00,
                    -1.60979138e00,
                    -6.14250754e-02,
                    3.18059991e00,
                    1.47075161e00,
                ],
                [
                    -4.63879160e-01,
                    -2.05094936e00,
                    1.04810580e00,
                    -1.25317992e00,
                    -1.32898517e00,
                    1.38142690e00,
                    7.37085671e-01,
                    1.88574871e00,
                    -2.48326905e00,
                    2.95822518e00,
                    -3.11876079e00,
                    4.63429229e-01,
                    -1.51341147e00,
                    -3.39908858e-01,
                    1.69733318e00,
                    -1.22081957e00,
                    -2.50814658e00,
                    5.39690878e-01,
                ],
                [
                    1.74011026e00,
                    -5.97038482e-01,
                    -1.93261047e00,
                    -1.44812897e00,
                    -8.43802899e-01,
                    -6.24330168e-01,
                    2.71285103e00,
                    2.65664030e00,
                    -2.32175824e00,
                    4.18167105e00,
                    9.70833445e-01,
                    -1.13697517e00,
                    -2.48910713e-01,
                    2.62149935e00,
                    -4.49091132e-03,
                    -1.31400020e00,
                    5.16497351e00,
                    -4.50184979e-01,
                ],
                [
                    -1.10920277e00,
                    1.75299073e00,
                    4.72849610e-01,
                    1.88673035e00,
                    2.68493654e00,
                    6.07291798e-01,
                    -3.72647607e00,
                    -3.77863860e-01,
                    -3.67345095e00,
                    -5.80404214e00,
                    4.97455413e-01,
                    -2.12426296e-01,
                    1.34150554e00,
                    -4.76173474e-01,
                    1.32728797e00,
                    -1.60298456e00,
                    1.19713582e00,
                    8.32674157e-01,
                ],
                [
                    1.59344688e00,
                    2.33762509e00,
                    -2.76097954e00,
                    -2.84218283e00,
                    2.38525292e00,
                    1.93273327e00,
                    -1.63748057e00,
                    -1.36485825e-02,
                    2.04126232e00,
                    -8.59350206e-01,
                    -4.99732624e-01,
                    2.53887179e00,
                    -7.59189138e-01,
                    -1.39079298e00,
                    1.33902692e00,
                    -1.90007919e00,
                    -2.63628975e00,
                    -1.36836397e00,
                ],
                [
                    -1.02322341e00,
                    3.63135508e-01,
                    -1.41059542e00,
                    2.13871383e00,
                    1.09364066e00,
                    -8.92934151e-01,
                    -1.65010525e00,
                    3.86870497e-01,
                    2.29050164e00,
                    1.45157782e00,
                    -8.90337692e-01,
                    -9.14253868e-01,
                    2.97723664e00,
                    1.52331644e00,
                    -1.95535611e00,
                    -4.47859226e-01,
                    -3.33300592e00,
                    7.40568699e-01,
                ],
                [
                    5.10829416e00,
                    6.12250914e-01,
                    4.09860981e00,
                    1.55472305e00,
                    -2.55902081e00,
                    -1.71345736e00,
                    -5.97696136e-01,
                    2.65117175e00,
                    -3.28311103e-01,
                    1.45997920e00,
                    3.78026737e00,
                    8.37043634e-01,
                    2.01363996e00,
                    3.02251650e00,
                    -3.28582557e00,
                    -2.73626261e00,
                    1.48412563e00,
                    1.30828336e-01,
                ],
                [
                    9.76972493e-01,
                    -8.69105495e-02,
                    -5.78591563e-01,
                    4.83489093e-01,
                    4.29639051e00,
                    3.14299118e-02,
                    7.46840511e-01,
                    2.72324321e00,
                    -1.09622383e00,
                    5.36853594e-01,
                    1.04761335e00,
                    -1.19976849e-01,
                    2.15964646e00,
                    7.41930294e-01,
                    2.20344564e-02,
                    4.44894750e-01,
                    -3.91386335e00,
                    7.93506834e-01,
                ],
                [
                    -1.75007841e00,
                    5.34236517e-01,
                    -1.08654935e00,
                    -1.59927380e00,
                    1.55618318e00,
                    -1.29491939e00,
                    6.98087330e-01,
                    2.82402835e00,
                    -1.55862501e00,
                    2.56398551e00,
                    -6.84351278e-02,
                    -1.27754019e00,
                    -1.86333083e00,
                    -8.23140207e-01,
                    -1.86477357e00,
                    2.06871637e-01,
                    -2.96410428e00,
                    4.35241386e-01,
                ],
                [
                    -1.47944685e00,
                    -3.44900642e00,
                    -2.94889906e-02,
                    4.60330195e-01,
                    2.40179247e00,
                    8.14490158e-01,
                    -4.39341226e-01,
                    -3.41499337e-01,
                    1.35567028e00,
                    3.87139969e00,
                    -5.05220528e-01,
                    -3.72199406e00,
                    8.30638716e-01,
                    -1.10472907e00,
                    3.74969764e00,
                    -7.07581009e-01,
                    -3.30090416e00,
                    -1.74558586e00,
                ],
                [
                    9.70793749e-01,
                    -4.45851902e00,
                    -2.37599148e00,
                    3.21186790e00,
                    -1.68457803e-01,
                    6.18773191e-01,
                    -2.48010912e00,
                    -9.45257463e-01,
                    1.12871503e00,
                    1.08773248e00,
                    -1.33210793e00,
                    2.70377568e00,
                    3.61067075e00,
                    9.10564574e-01,
                    -2.27472702e00,
                    -3.07354778e00,
                    -4.59717412e00,
                    -1.46238183e00,
                ],
                [
                    -3.03277894e00,
                    -2.29059590e00,
                    -1.37987653e-01,
                    2.05795307e00,
                    3.91601418e-01,
                    -1.63078458e00,
                    -1.84245159e00,
                    1.02108132e00,
                    1.36172367e00,
                    -1.14086245e00,
                    -2.20833339e00,
                    2.73466045e00,
                    -1.76305716e00,
                    1.05993013e00,
                    -7.51991936e-01,
                    -2.76119226e00,
                    -3.84669124e00,
                    2.28679253e-01,
                ],
                [
                    -1.73480781e00,
                    -1.15396069e00,
                    1.91845109e00,
                    2.38154634e00,
                    -7.65202653e-01,
                    -3.22302543e00,
                    -2.60681070e00,
                    4.31882009e-01,
                    2.35544852e00,
                    -5.74333654e-01,
                    3.37666057e-01,
                    -6.49927767e-01,
                    1.17131680e00,
                    3.26073676e00,
                    7.69342732e-01,
                    2.95595040e00,
                    -4.59905051e-01,
                    -3.67463320e00,
                ],
                [
                    2.80167828e00,
                    -4.79825689e-01,
                    -7.34081116e-01,
                    1.42907808e00,
                    2.84579970e00,
                    1.16487833e00,
                    -2.76955572e-01,
                    -1.58752025e00,
                    -1.10890065e00,
                    -7.75875534e-01,
                    -8.55179151e-01,
                    -1.22975240e00,
                    -6.40602682e-01,
                    1.74478513e00,
                    -3.31977981e-01,
                    -2.23789997e00,
                    5.94162243e-01,
                    2.01070447e00,
                ],
                [
                    3.91121003e00,
                    3.02209759e00,
                    -9.05523672e-01,
                    -2.24374237e00,
                    2.70566684e00,
                    -1.50461434e00,
                    1.21534520e-01,
                    5.09591270e-01,
                    3.05659109e-01,
                    -7.76773571e-01,
                    1.98363349e00,
                    -1.29617323e00,
                    -2.05679928e00,
                    -2.56710048e-01,
                    1.15953780e00,
                    3.00212262e00,
                    -1.91935730e00,
                    -1.18369393e00,
                ],
                [
                    1.32901736e00,
                    3.88399850e00,
                    -7.06571389e-02,
                    3.27474352e-01,
                    8.68332538e-01,
                    -1.12148047e00,
                    2.32553728e00,
                    -2.30936656e00,
                    -1.24200350e-01,
                    -7.45968914e-02,
                    2.29751580e00,
                    -1.59883814e-01,
                    3.42936140e00,
                    1.81312286e00,
                    1.60611728e00,
                    -1.42263816e-01,
                    -1.92786090e00,
                    -1.00364961e00,
                ],
                [
                    -1.38140406e00,
                    -1.13613070e00,
                    -2.57560728e-01,
                    8.09954918e-01,
                    1.43633570e00,
                    1.22276779e00,
                    -4.59173885e-01,
                    1.64183098e00,
                    3.00428094e-01,
                    1.01979921e00,
                    -1.10900197e00,
                    -2.67003649e00,
                    3.71343602e00,
                    2.45896706e00,
                    -3.00207579e-01,
                    -2.86868605e-01,
                    2.46656028e00,
                    5.38399797e-01,
                ],
            ],
            [
                [
                    2.14634297,
                    -1.05117397,
                    -2.73829782,
                    4.27958107,
                    0.71812592,
                    1.77540768,
                    2.09580702,
                    1.12556066,
                    2.13182301,
                    4.81547394,
                    -2.62939934,
                    0.24311262,
                    0.1335384,
                    -0.36526448,
                    -2.26318791,
                    -1.20120761,
                    0.75259079,
                    1.75719254,
                    2.99840505,
                    -3.61136966,
                    0.720133,
                    1.27415772,
                ],
                [
                    -0.47609389,
                    0.84739225,
                    1.04731835,
                    3.34212933,
                    0.77287543,
                    -1.31885063,
                    2.34061581,
                    1.02731624,
                    -0.7196778,
                    -1.94953791,
                    -0.4342535,
                    0.36030232,
                    0.01333255,
                    -0.3212578,
                    1.23857172,
                    -1.94519078,
                    -1.04789322,
                    -0.10368419,
                    0.2759067,
                    -1.44267601,
                    -1.89598262,
                    1.69560879,
                ],
                [
                    -0.07923753,
                    2.39969897,
                    -1.89754957,
                    1.82500449,
                    1.05760871,
                    0.81747885,
                    0.35212237,
                    -1.15880259,
                    -3.50443227,
                    0.62076264,
                    -1.42793595,
                    -2.72173855,
                    0.96862552,
                    -2.14007497,
                    3.11039814,
                    2.23132147,
                    -0.03316155,
                    -0.8722491,
                    -1.91409997,
                    3.41600833,
                    -1.75666209,
                    -1.11859185,
                ],
                [
                    2.34052876,
                    0.58317916,
                    -1.28829821,
                    -0.35661445,
                    -0.33969088,
                    1.9018574,
                    1.81158519,
                    -3.19706431,
                    3.52609618,
                    0.98420918,
                    2.20117983,
                    -0.97799593,
                    2.26653222,
                    0.71317631,
                    -2.50741882,
                    -0.61539955,
                    -2.23701389,
                    -1.01585304,
                    -1.55351534,
                    -0.63013748,
                    1.56369093,
                    1.87571295,
                ],
                [
                    -0.3240295,
                    1.14705028,
                    3.95127049,
                    -2.03878345,
                    -0.38855365,
                    0.45489485,
                    -1.83616566,
                    -1.22469241,
                    0.96468816,
                    -0.22862126,
                    3.17085131,
                    1.59089465,
                    -1.47750107,
                    1.86521179,
                    0.63501108,
                    -1.56540769,
                    -2.00765977,
                    0.26571948,
                    -0.27746575,
                    -1.11048683,
                    -3.63940955,
                    1.6371762,
                ],
                [
                    0.25009837,
                    -0.01367616,
                    -1.86155794,
                    -0.30970165,
                    -0.47198589,
                    -2.42096097,
                    -2.51566011,
                    2.71510669,
                    0.17786438,
                    2.75945842,
                    0.96376874,
                    -1.74118665,
                    1.12759434,
                    -0.28894367,
                    -2.86997251,
                    0.33910439,
                    -1.15412207,
                    3.76693898,
                    -1.03771627,
                    -0.46879493,
                    2.14341468,
                    1.55035306,
                ],
                [
                    3.45339318,
                    -0.65045186,
                    -3.14292819,
                    2.41356772,
                    3.23358757,
                    -0.03909685,
                    -0.345296,
                    2.23248088,
                    3.20847233,
                    -1.24235211,
                    0.40611517,
                    0.94346179,
                    -2.92677462,
                    0.74797745,
                    -0.48251349,
                    -2.27229768,
                    -0.48963854,
                    -0.52567868,
                    0.53464725,
                    1.4240202,
                    -1.32059307,
                    -0.56864792,
                ],
                [
                    -1.00676196,
                    0.96138263,
                    -1.55609576,
                    -2.27116291,
                    -0.55891435,
                    1.34417118,
                    1.95635184,
                    0.71246337,
                    -2.46209646,
                    -0.88427965,
                    -3.2508227,
                    -0.35227582,
                    -1.51668121,
                    -0.96433624,
                    -2.42820441,
                    -0.31858699,
                    -2.05285026,
                    1.49718284,
                    -3.92015025,
                    -1.22077656,
                    2.12113935,
                    -0.66953278,
                ],
                [
                    1.28124328,
                    2.83759559,
                    1.33467054,
                    -2.52892142,
                    -1.75621429,
                    1.97020505,
                    -1.11878541,
                    -0.17669872,
                    -3.95892138,
                    -1.19142925,
                    0.0671605,
                    -0.55429884,
                    1.98908659,
                    0.30130715,
                    3.15897296,
                    -0.03078675,
                    1.61865059,
                    0.60830791,
                    3.42599482,
                    -1.51249313,
                    -2.07599103,
                    1.22821582,
                ],
                [
                    -2.05783714,
                    -1.89300796,
                    -1.1327762,
                    -2.04315523,
                    -2.44446743,
                    1.2259399,
                    3.23533772,
                    1.50579487,
                    0.59104557,
                    2.44336952,
                    -0.99189663,
                    -1.04272385,
                    -1.09545927,
                    -3.32141947,
                    -1.05481891,
                    2.63358489,
                    1.0848496,
                    0.51758952,
                    -1.72237323,
                    -2.77529932,
                    -1.3641131,
                    -2.56296681,
                ],
                [
                    -3.05737919,
                    -1.30690581,
                    -1.49321323,
                    -1.80251826,
                    -1.47962102,
                    -1.38881132,
                    3.52510551,
                    -1.94527014,
                    2.38574722,
                    -3.98554409,
                    1.10424942,
                    1.0032827,
                    -2.386081,
                    -0.46693181,
                    -2.52247129,
                    1.122741,
                    -3.0180479,
                    -1.81088698,
                    -1.76802147,
                    3.1298258,
                    -0.97605295,
                    -1.32149527,
                ],
                [
                    1.62091972,
                    0.06179983,
                    2.46775831,
                    0.25580568,
                    1.41886552,
                    3.57917384,
                    -0.34516819,
                    -0.17383757,
                    1.86161554,
                    -1.56054538,
                    -1.7759928,
                    2.83730443,
                    -1.06774162,
                    -4.13765963,
                    0.94087726,
                    0.20620036,
                    0.94692321,
                    2.23258176,
                    2.26797362,
                    -0.16031981,
                    -1.64734108,
                    -3.35319172,
                ],
                [
                    -1.83639811,
                    -0.13179707,
                    1.5739667,
                    -0.72339727,
                    -0.9458685,
                    -0.18347271,
                    0.28003781,
                    1.81282261,
                    -0.45721842,
                    -1.12719991,
                    2.70449762,
                    -0.33308729,
                    4.88603197,
                    0.5310674,
                    2.23496369,
                    -0.81893902,
                    2.59721467,
                    1.89474651,
                    -0.69119798,
                    -0.4957423,
                    -2.25087855,
                    1.80411131,
                ],
                [
                    0.69231464,
                    -0.79294891,
                    -0.23843178,
                    0.62155031,
                    -0.98818982,
                    -0.26415348,
                    3.07555431,
                    1.65344238,
                    2.47453858,
                    1.01073476,
                    1.86875241,
                    0.39071561,
                    1.98107154,
                    1.93725776,
                    -1.46478178,
                    -1.69549926,
                    0.02303902,
                    0.31668174,
                    -0.89020477,
                    -1.78367449,
                    2.840896,
                    -1.13149717,
                ],
                [
                    -0.17707013,
                    -0.66491508,
                    -2.84336182,
                    1.70571389,
                    -2.90064001,
                    -0.63745864,
                    -0.85898576,
                    1.78014021,
                    -0.58634474,
                    1.40284414,
                    -3.44520946,
                    -2.76533049,
                    -1.65447728,
                    -2.93702529,
                    1.54937086,
                    -0.78521697,
                    0.9786604,
                    -2.22482222,
                    -0.55727389,
                    1.11138182,
                    -0.98177181,
                    0.38800038,
                ],
                [
                    0.56412818,
                    1.97908593,
                    1.73992928,
                    2.21448814,
                    1.18582072,
                    -3.38884597,
                    1.33085087,
                    -0.93911068,
                    0.45793484,
                    -0.81002757,
                    -2.1955476,
                    0.16002312,
                    2.58130146,
                    -1.13616842,
                    0.06162297,
                    -0.37256623,
                    -3.93479423,
                    0.00813315,
                    -1.10610612,
                    3.08542614,
                    0.37310836,
                    -1.49115644,
                ],
                [
                    0.17150992,
                    -1.44672232,
                    -0.11108514,
                    -1.51834864,
                    3.72607073,
                    -2.20033705,
                    0.44332853,
                    -0.93579593,
                    -0.27089091,
                    -0.47296453,
                    -0.69400101,
                    1.19633001,
                    -4.21605585,
                    -0.9582785,
                    -0.97088406,
                    -3.42828285,
                    -1.72179287,
                    -1.47038446,
                    1.50491294,
                    -0.98011409,
                    1.89828465,
                    -0.77132216,
                ],
                [
                    0.07768222,
                    -0.22128522,
                    -0.83402901,
                    -1.70262872,
                    -3.03183319,
                    2.91657069,
                    -3.17002488,
                    -1.58487378,
                    -2.32475438,
                    1.17512927,
                    -0.91829331,
                    -0.88694144,
                    -1.36288146,
                    2.39716047,
                    2.41491197,
                    0.97542279,
                    0.31059641,
                    -2.35391126,
                    2.42394605,
                    -0.903665,
                    -0.69307954,
                    3.23286858,
                ],
                [
                    -0.28669331,
                    0.51151614,
                    -0.06483994,
                    2.07427365,
                    -1.27546987,
                    1.43195397,
                    2.11685452,
                    -2.59948348,
                    0.37652004,
                    -0.74108861,
                    -1.29998681,
                    -0.10636942,
                    -1.62593904,
                    0.4072233,
                    0.06546884,
                    0.09208618,
                    0.20168202,
                    0.70624309,
                    1.63740354,
                    -0.43517326,
                    -0.28756886,
                    2.32569403,
                ],
                [
                    1.35084203,
                    -2.18071425,
                    2.56804003,
                    1.75099159,
                    1.61401766,
                    -1.52219956,
                    0.81255623,
                    -0.20713017,
                    0.97917821,
                    1.30662125,
                    -0.26213117,
                    0.07448484,
                    0.51701164,
                    -0.48619708,
                    -3.86756326,
                    1.30827968,
                    -0.21550886,
                    1.33061764,
                    2.6484922,
                    1.39460683,
                    -1.37770317,
                    0.79268244,
                ],
                [
                    0.2774381,
                    -1.6026095,
                    2.20826529,
                    3.32711585,
                    -1.35188368,
                    1.90690511,
                    0.0721401,
                    -1.46867751,
                    0.55127798,
                    -2.07672654,
                    1.91023831,
                    0.02618224,
                    1.79548814,
                    1.82494785,
                    0.38298767,
                    1.13706387,
                    -0.8354955,
                    0.99670051,
                    2.59396718,
                    -3.46200265,
                    2.33439522,
                    2.59786988,
                ],
                [
                    -3.65598259,
                    0.43303775,
                    -0.50237149,
                    -0.98347125,
                    -2.72216271,
                    -0.26192988,
                    0.57314532,
                    -2.28552315,
                    -1.91141483,
                    3.31230819,
                    2.40988424,
                    1.10110934,
                    -0.44777102,
                    -0.46708789,
                    -1.38095187,
                    -0.30075872,
                    -2.50119018,
                    -3.66283937,
                    -1.62192745,
                    2.01476116,
                    -1.20014895,
                    2.00536078,
                ],
                [
                    1.54545581,
                    -5.81012782,
                    2.16174023,
                    2.14123468,
                    1.11539963,
                    0.65148127,
                    -0.69249691,
                    -1.10431507,
                    0.33426084,
                    0.24994961,
                    0.67385244,
                    -1.12150566,
                    -2.25202038,
                    0.07280316,
                    0.56110206,
                    -1.77803585,
                    -2.61917443,
                    2.0019929,
                    -2.24702919,
                    3.82716239,
                    1.66191458,
                    -3.24637908,
                ],
                [
                    0.08199974,
                    0.04310794,
                    0.04198771,
                    2.17905561,
                    1.3990417,
                    -2.91708854,
                    2.90289624,
                    -0.5160246,
                    -0.93638149,
                    -0.72588137,
                    -0.97878185,
                    1.73029663,
                    -1.72357794,
                    2.71289647,
                    -2.28871264,
                    -1.22367691,
                    -1.02612717,
                    1.3604826,
                    1.76874076,
                    -1.15632824,
                    3.58744716,
                    -1.12417639,
                ],
            ],
            [
                [
                    -2.18235979e00,
                    9.15968272e-01,
                    -2.20314925e00,
                    1.66803956e00,
                    1.83310372e00,
                    2.46472601e00,
                    2.77592929e00,
                    2.31616334e00,
                    -2.34519115e00,
                    -2.28071046e00,
                    2.66984748e-01,
                    -8.69845635e-01,
                    2.87383666e00,
                    -1.05185955e00,
                    -2.04792966e00,
                    -4.55943638e-01,
                    -1.89145811e00,
                    -1.11826733e00,
                    -4.16525175e00,
                    1.23185113e00,
                    -1.95379246e00,
                    -5.00447046e00,
                    1.78700898e00,
                    -1.57761878e00,
                ],
                [
                    -1.95923701e00,
                    -1.93964632e00,
                    1.62729201e00,
                    -2.18334237e00,
                    -1.23319271e00,
                    -1.29852433e-01,
                    -2.72837095e00,
                    -4.67471131e00,
                    1.53955957e-01,
                    -1.18759789e00,
                    -1.53760654e-01,
                    6.68692693e-01,
                    -7.04719376e-01,
                    -6.32038509e-01,
                    -1.02985589e00,
                    3.23962088e-01,
                    -1.67929838e00,
                    -3.84361198e00,
                    8.82929014e-01,
                    5.05755775e-01,
                    -3.67135622e00,
                    1.46879783e00,
                    -1.01274624e00,
                    2.20468220e00,
                ],
                [
                    -2.01482044e00,
                    1.60525544e-01,
                    9.46483739e-01,
                    -4.94572395e-01,
                    -2.82436533e00,
                    -4.64085674e00,
                    5.30494128e-02,
                    1.43961699e-02,
                    -3.36026894e00,
                    -1.45523456e-01,
                    -3.82888672e00,
                    -4.35760662e-01,
                    2.06899644e00,
                    1.46341120e00,
                    9.89411410e-01,
                    -7.37272332e-01,
                    8.61482407e-01,
                    -1.71822468e00,
                    3.15193646e00,
                    -1.22513476e-01,
                    2.57272346e00,
                    7.89754676e-01,
                    -1.11245599e00,
                    3.64331212e-01,
                ],
                [
                    5.78715588e-01,
                    -3.18338916e00,
                    1.61439165e00,
                    -7.93829010e-01,
                    8.16596345e-01,
                    2.72062798e00,
                    -3.08342489e-01,
                    -2.36620595e00,
                    1.68875173e00,
                    1.69264954e00,
                    -3.27540566e-01,
                    -1.30955147e00,
                    -2.84381457e00,
                    4.16790464e00,
                    -1.00690278e00,
                    -1.80957257e00,
                    3.96138585e-01,
                    1.56181827e00,
                    8.78717101e-01,
                    -6.29695359e00,
                    2.88763331e-01,
                    -1.41047689e-01,
                    3.76111040e-01,
                    -1.87983699e00,
                ],
                [
                    -6.44712491e-01,
                    5.51248588e-01,
                    1.21067073e00,
                    1.27772451e00,
                    8.86087315e-02,
                    -1.94986124e00,
                    -2.63915465e-01,
                    -1.43752850e00,
                    -1.12191534e00,
                    1.55707949e00,
                    -6.19264489e00,
                    -8.87662281e-02,
                    1.86985145e00,
                    1.86933890e00,
                    1.88336507e00,
                    -5.69305873e-01,
                    -1.14871178e00,
                    1.46573140e00,
                    2.71343956e00,
                    -2.35929369e00,
                    -3.74818037e00,
                    -3.25603636e00,
                    1.21113536e00,
                    -1.69991228e00,
                ],
                [
                    7.69109503e-01,
                    3.83489202e00,
                    -1.83440146e00,
                    1.83622156e00,
                    -3.83061412e00,
                    -8.81251556e-01,
                    -7.29542800e-01,
                    -7.17189517e-01,
                    1.70607787e-01,
                    -3.19112101e-01,
                    3.16389091e00,
                    -9.29669669e-02,
                    6.17133055e-02,
                    7.29584322e-01,
                    4.30684608e-01,
                    2.80882277e-01,
                    1.24914604e00,
                    2.12977374e-01,
                    -9.55063360e-01,
                    5.34590592e-01,
                    4.42192184e-01,
                    -5.46647526e-02,
                    -5.29457301e00,
                    -1.09274321e-01,
                ],
                [
                    -1.48054094e00,
                    -1.03101078e00,
                    -2.36283622e00,
                    2.98582238e-01,
                    1.57449028e00,
                    -2.46874115e00,
                    -3.59634670e00,
                    2.14052948e-01,
                    -1.51238454e00,
                    4.91404966e00,
                    -2.42119916e00,
                    -1.03007782e00,
                    1.45210343e00,
                    -1.42355945e00,
                    1.37462719e00,
                    -6.92566083e-01,
                    1.26434306e00,
                    -2.93429790e-01,
                    1.19472070e00,
                    -3.51003638e-01,
                    -1.19524331e00,
                    2.53097693e00,
                    -7.58936026e-01,
                    -1.57685013e00,
                ],
                [
                    -4.93464306e-01,
                    4.62110073e-01,
                    3.23649326e00,
                    -1.12740010e00,
                    -6.15322549e-01,
                    3.58553778e00,
                    6.78689483e-01,
                    -2.73819790e00,
                    1.07658610e00,
                    -1.12038033e00,
                    1.86660269e00,
                    2.05632547e00,
                    3.32942831e00,
                    2.56239006e-01,
                    -1.24637988e00,
                    -2.38753332e00,
                    -1.22332202e00,
                    2.31583086e00,
                    1.06886021e00,
                    -2.48652252e00,
                    4.46227219e00,
                    2.79001879e-01,
                    -1.97984340e00,
                    -5.08929257e-01,
                ],
                [
                    -5.74870766e-02,
                    1.45694928e00,
                    -5.29310169e-01,
                    -7.02729300e-01,
                    1.60030059e00,
                    2.31315281e00,
                    2.16637567e00,
                    -4.61522164e-01,
                    1.67736915e00,
                    -1.30370115e00,
                    4.05132373e00,
                    -1.11758621e00,
                    6.43657886e-01,
                    -8.95169906e-01,
                    9.15935851e-01,
                    -8.49850225e-01,
                    -2.79721698e-01,
                    -7.71515441e-01,
                    -2.79221459e00,
                    -2.57796313e00,
                    -8.65251323e-01,
                    -9.84709898e-01,
                    -1.35634613e00,
                    -8.54361348e-02,
                ],
                [
                    -2.14923892e00,
                    4.16645222e00,
                    1.33590703e00,
                    -2.55520336e00,
                    1.96340730e00,
                    -1.41584891e00,
                    -1.36509068e-01,
                    2.19096138e-01,
                    1.43060705e00,
                    -2.13067255e00,
                    1.41687676e00,
                    2.00228118e00,
                    3.78773358e00,
                    1.42581940e00,
                    2.10007207e00,
                    -9.08481217e-01,
                    -2.71535100e00,
                    -6.51484691e-02,
                    -1.15765107e00,
                    -9.71686905e-01,
                    -3.24862211e00,
                    -9.23564620e-02,
                    -2.99007386e-01,
                    -3.40825429e-02,
                ],
                [
                    -3.47115604e-01,
                    -8.59663324e-01,
                    1.64353844e00,
                    6.73838096e-01,
                    -1.53135519e00,
                    -2.02138441e00,
                    -4.25053395e00,
                    9.74379926e-01,
                    -6.53031223e-01,
                    -8.57072986e-01,
                    -1.21958853e00,
                    -1.01629191e00,
                    1.06954254e00,
                    1.15407326e-01,
                    -6.31621233e-02,
                    -1.44146214e00,
                    1.87589491e00,
                    -5.20246329e-01,
                    -2.35206321e00,
                    -2.18195989e00,
                    -2.13238113e00,
                    2.17927199e00,
                    2.04543992e00,
                    -1.59429154e00,
                ],
                [
                    -8.22942575e-01,
                    1.19919211e00,
                    3.71686066e00,
                    -3.48790504e00,
                    3.18227291e-01,
                    -2.94031073e00,
                    5.21719205e-01,
                    4.50937880e-01,
                    -7.80144833e-01,
                    2.45922952e00,
                    -2.65478290e-02,
                    -2.30511604e-01,
                    -9.20248575e-01,
                    1.26301661e00,
                    -8.14045031e-01,
                    8.63955547e-01,
                    -2.37398761e00,
                    -1.42676643e00,
                    -9.86285834e-01,
                    9.54548108e-01,
                    -4.91920271e-01,
                    -1.85997055e-01,
                    -3.16165634e-01,
                    -5.86320840e-01,
                ],
                [
                    -7.78428556e-01,
                    1.22128249e-01,
                    -9.25289847e-01,
                    3.01977622e00,
                    2.17843001e00,
                    -3.64502518e00,
                    -1.51352018e00,
                    6.63964774e-01,
                    -1.42984049e00,
                    -2.21059118e00,
                    3.66061802e-01,
                    3.27775184e-01,
                    -4.25958657e-01,
                    2.04534962e00,
                    -3.01067087e00,
                    1.93097158e00,
                    -3.69563925e00,
                    1.68532916e-01,
                    9.13920771e-01,
                    -7.54467937e-01,
                    -2.38260448e00,
                    4.37587730e-01,
                    5.14190361e-01,
                    8.17977216e-01,
                ],
                [
                    -2.69638345e-01,
                    -1.65663960e-01,
                    6.46169737e-01,
                    -9.18079465e-01,
                    5.10002928e-01,
                    -1.76027564e00,
                    -1.16002000e-01,
                    -2.11609127e00,
                    -3.15991406e00,
                    -1.64120246e00,
                    5.05499102e00,
                    -1.35003801e00,
                    1.02575390e00,
                    -8.14125591e-01,
                    -2.83991204e00,
                    3.11584449e00,
                    -2.41314736e00,
                    7.43272373e-01,
                    -1.97783953e00,
                    7.09760952e-01,
                    2.19674394e-01,
                    5.73064180e-01,
                    6.38097656e-01,
                    1.74733404e00,
                ],
                [
                    -3.13885751e00,
                    2.02861676e-01,
                    3.56574581e00,
                    9.14502353e-01,
                    6.40143206e-01,
                    -6.19789955e-01,
                    -1.61019203e00,
                    2.56815087e-05,
                    4.61038150e00,
                    -3.53787068e-04,
                    2.25891819e00,
                    -1.35290298e00,
                    -3.50797678e00,
                    -9.88263582e-01,
                    2.57481183e00,
                    -1.16299984e00,
                    -1.42364363e00,
                    -1.38883638e00,
                    -1.29106251e-01,
                    -3.28722980e00,
                    -4.53537484e00,
                    -1.39565862e00,
                    5.57103235e-01,
                    1.07641779e00,
                ],
                [
                    1.56472567e00,
                    -1.22982624e-01,
                    5.95882273e00,
                    -1.10755467e00,
                    2.50104651e00,
                    1.49379099e00,
                    2.92747784e00,
                    -1.30796278e00,
                    1.97628297e00,
                    -2.55130096e-01,
                    -1.50765014e00,
                    1.92047528e00,
                    -1.24124180e00,
                    4.14773859e-01,
                    8.48780498e-01,
                    -1.11478136e00,
                    -6.94089541e-01,
                    2.07448964e00,
                    -3.48625930e00,
                    3.20738140e00,
                    -2.14357047e00,
                    -2.23849531e00,
                    5.68022769e-02,
                    -9.53521588e-01,
                ],
                [
                    -1.50025379e00,
                    -5.11926357e-01,
                    3.88186880e00,
                    7.53927374e-01,
                    -5.67172555e-01,
                    1.01428919e00,
                    1.52297032e00,
                    -5.72408747e-01,
                    -1.41558355e00,
                    5.58320325e-01,
                    -2.18523252e-01,
                    1.20320177e-01,
                    -1.07668605e00,
                    -4.85972809e-01,
                    2.43181091e00,
                    -4.15577137e00,
                    3.42251413e00,
                    -1.76869861e00,
                    1.73919654e00,
                    -3.88890739e-01,
                    -1.76591952e-01,
                    1.04343432e00,
                    5.19231751e-01,
                    -1.63773643e00,
                ],
                [
                    8.90020128e-01,
                    -8.57607223e-01,
                    -6.84358959e-02,
                    -8.10784660e-01,
                    2.68750569e00,
                    -6.35273500e-01,
                    1.16165738e-01,
                    1.54738822e-01,
                    1.33558947e00,
                    -4.30476596e00,
                    -2.63313892e00,
                    1.13284579e00,
                    3.20366845e00,
                    1.84391245e00,
                    -2.43208350e00,
                    -1.74897560e00,
                    -1.61556826e00,
                    -3.50988178e-01,
                    -7.00246828e-01,
                    1.89839607e00,
                    -1.25012196e00,
                    -5.60815271e-01,
                    -1.88892570e00,
                    -1.92981619e00,
                ],
                [
                    -3.77526674e-01,
                    1.46001461e00,
                    1.69177002e00,
                    1.45051810e00,
                    -2.09868384e00,
                    -2.74681881e00,
                    -1.89294776e00,
                    1.63759944e00,
                    -8.26236684e-01,
                    -7.84278639e-02,
                    -6.86496807e-01,
                    1.68741466e00,
                    -2.66608524e-01,
                    1.08543041e-01,
                    1.72654579e00,
                    -1.30803175e00,
                    -9.43375437e-01,
                    -1.64525419e00,
                    7.36360583e-01,
                    1.38396531e00,
                    1.67271094e-01,
                    1.86701981e00,
                    -3.83628828e00,
                    -1.07988564e00,
                ],
                [
                    8.12042722e-01,
                    -1.33052799e-01,
                    -2.09478172e00,
                    -9.30545875e-01,
                    -7.33056918e-01,
                    3.25904378e00,
                    -4.63596007e-01,
                    -1.40833311e00,
                    2.80193925e00,
                    -2.55893689e00,
                    -1.96803348e-02,
                    -2.46995960e00,
                    2.76882043e00,
                    5.14658319e-01,
                    5.92507128e-01,
                    -2.01089282e00,
                    -3.79506062e-01,
                    -1.69444351e00,
                    -1.27238552e00,
                    2.50214546e00,
                    4.91228709e-01,
                    3.42115634e00,
                    -1.14171239e00,
                    -2.87376347e00,
                ],
                [
                    1.25644953e00,
                    1.95721661e00,
                    3.67908179e-01,
                    7.00628834e-01,
                    9.52113958e-01,
                    -2.17190228e-01,
                    -2.46059849e00,
                    -6.06986168e-02,
                    -2.69646335e-01,
                    -8.77359129e-01,
                    -7.30632657e-01,
                    -8.25572881e-01,
                    2.57580017e00,
                    -1.09699041e00,
                    -6.73934073e-01,
                    2.54964005e00,
                    2.76809466e-01,
                    -6.57701071e-01,
                    5.36924964e-01,
                    -1.19288405e00,
                    -2.52111801e00,
                    2.60841529e00,
                    2.07116258e-01,
                    -4.60271285e-01,
                ],
                [
                    3.21518353e-01,
                    7.30964192e-01,
                    3.95849692e-01,
                    1.88412910e00,
                    1.91634546e00,
                    8.33387169e-01,
                    -7.58117653e-01,
                    1.89308752e-01,
                    2.01955035e00,
                    -1.66916587e00,
                    6.85575917e-01,
                    -5.08783999e-01,
                    -1.02356470e00,
                    -2.00034456e00,
                    -3.43887369e00,
                    -2.29853643e00,
                    -5.78799602e-01,
                    -2.79324163e00,
                    1.74373029e-01,
                    1.05030377e00,
                    9.39294723e-01,
                    -9.53743456e-01,
                    -2.71448325e00,
                    1.55960360e00,
                ],
                [
                    -2.00130493e-01,
                    3.52965668e00,
                    3.14130829e00,
                    1.39258251e00,
                    -2.51594338e00,
                    2.42044678e-02,
                    5.39481593e00,
                    2.38258790e-01,
                    -6.31767393e-01,
                    -1.38994951e00,
                    -2.02616391e00,
                    2.94742725e00,
                    -1.48034691e00,
                    3.50448754e-01,
                    1.94033932e-01,
                    -9.15723328e-01,
                    2.18041232e00,
                    -8.01503792e-01,
                    -2.26693290e-01,
                    2.39436774e00,
                    -3.38310563e-02,
                    1.39975946e00,
                    -2.03415624e00,
                    3.31809618e00,
                ],
                [
                    -3.19563917e-01,
                    1.58645877e00,
                    2.79309096e00,
                    -1.95349449e00,
                    1.43652008e00,
                    9.35365079e-01,
                    2.11770028e-01,
                    7.89275613e-01,
                    2.90334548e-01,
                    -3.05651818e00,
                    -1.16535072e00,
                    2.17738831e00,
                    -2.13025647e00,
                    3.84184269e00,
                    -1.34778898e00,
                    6.95161665e-01,
                    -2.82182220e-01,
                    -1.21661968e00,
                    -1.39650713e00,
                    -1.39038674e00,
                    -8.04963226e-01,
                    -7.07807169e-01,
                    2.59749237e00,
                    1.48720461e00,
                ],
                [
                    -8.02062032e-01,
                    -1.95498891e00,
                    -7.33252960e-01,
                    -2.92768192e-01,
                    -6.82373023e-01,
                    5.90430361e-01,
                    -4.37060761e-02,
                    -1.37828715e-01,
                    -3.15047952e00,
                    3.02085428e00,
                    -1.54333605e-01,
                    -1.25561849e00,
                    -3.42632888e-01,
                    -1.07522974e00,
                    2.08310240e-03,
                    -1.04794424e00,
                    8.74478435e-01,
                    -8.86876835e-01,
                    -1.03971208e00,
                    1.61220792e00,
                    5.00053958e-01,
                    1.24655738e00,
                    -7.11391311e-01,
                    -1.94296899e00,
                ],
                [
                    -2.98931720e-01,
                    3.58719910e00,
                    -2.38483890e00,
                    3.67319106e-01,
                    -2.36795717e00,
                    -2.09581398e00,
                    -3.78752382e-01,
                    3.52699539e-01,
                    -5.06750721e-01,
                    -1.95982773e00,
                    7.10227091e-01,
                    -1.68422063e00,
                    -1.93777596e00,
                    -1.53295366e00,
                    -2.05171685e00,
                    -3.29000782e-01,
                    3.34078828e00,
                    3.67313352e00,
                    -9.31213278e-01,
                    2.92289444e00,
                    -2.15809629e00,
                    1.78907616e-01,
                    -8.16148396e-01,
                    -9.27073645e-01,
                ],
                [
                    -1.74460926e00,
                    -5.98596311e-01,
                    -1.70973808e00,
                    3.19933615e00,
                    -3.07373197e-01,
                    -1.77182972e00,
                    -2.12685517e00,
                    -2.59121793e00,
                    -6.91791336e-01,
                    -2.32680813e00,
                    1.09945112e00,
                    4.15700789e00,
                    -9.39600540e-01,
                    -1.29913582e00,
                    5.67833185e00,
                    -2.11314550e00,
                    8.33504576e-01,
                    -3.84399025e00,
                    -1.71970014e00,
                    -9.24788157e-01,
                    -2.21751208e00,
                    -3.60272217e00,
                    -1.64297859e00,
                    -1.19853455e00,
                ],
            ],
        ]

        biases = [
            [
                -0.03544457,
                0.84132576,
                0.27220519,
                1.31586349,
                0.08172807,
                0.66397027,
                1.06879024,
                0.23213688,
                0.88503563,
                0.57879281,
                -0.48996042,
                -1.46102129,
                1.05393391,
                0.09681745,
                -0.41728814,
                2.38518382,
                1.19756335,
                1.04547529,
                0.89283096,
                0.25348247,
                -0.87889417,
                0.14652213,
            ],
            [
                -1.53243775,
                0.14000192,
                1.15983565,
                0.10345674,
                -0.89417905,
                -1.19741808,
                0.3986461,
                0.54937634,
                -0.42547085,
                -2.01953647,
                0.61486229,
                2.23094325,
                -0.01619129,
                0.39758146,
                -0.3112372,
                -0.63746459,
                -0.37816201,
                -0.46810219,
                -0.91303878,
                1.25699532,
                -0.15576977,
                -0.90875575,
                0.78011448,
                -0.15994024,
            ],
            [
                0.57726465,
                0.93668691,
                1.98535521,
                1.14615762,
                -1.24532946,
                0.0581868,
                1.68869011,
                0.82942524,
                -0.07846983,
                -1.84926299,
                -0.94872621,
                1.58771493,
                -0.85781406,
                1.02546875,
                1.82625726,
                -0.64265764,
                0.28504794,
                -0.65357518,
                1.2842384,
                0.67058183,
                -0.06474067,
                -0.36826887,
                -1.36360231,
                -0.08074308,
                1.10372136,
                -2.50372474,
                0.74357594,
            ],
        ]

        activation_functions = [relu, relu, linear]

        self.neural_network = NeuralNetwork(
            weights,
            biases,
            activation_functions
        )

    def play(self, player_state, opponent_state,
             player_score, opponent_score,
             turn, length, pip_count):
        player_state = numpy.array(player_state)
        opponent_state = numpy.array(opponent_state)

        # Sum each column, row, and grid
        column_sums = numpy.ravel(
            [player_state.sum((0, 1)), -(opponent_state.sum((0, 1)))], "F"
        )
        row_sums = numpy.ravel(
            [player_state.sum((0, 2)), -(opponent_state.sum((0, 2)))], "F"
        )
        grid_sums = numpy.ravel(
            [player_state.sum((1, 2)), -(opponent_state.sum((1, 2)))], "F"
        )

        nn_inputs = numpy.concatenate((column_sums, row_sums, grid_sums))

        # Run neural network for current turn
        output = self.neural_network.propagate(nn_inputs)

        # Index on board as if a 1D array
        board_position = int(numpy.argmax(output))

        # Convert 1D index to grid, row, and column indexes
        grid = board_position % GRID_COUNT
        row = (board_position // GRID_COUNT) % ROW_LENGTH
        column = board_position // (ROW_LENGTH * COLUMN_LENGTH)

        return [grid, row, column]

    def getNN(self):
        return self.neural_network
